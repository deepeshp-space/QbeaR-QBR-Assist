<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2685.3">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;QBeaR: QBR Assist&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Tailwind CSS --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>tailwind.config = {</p>
<p class="p1"><span class="Apple-converted-space">            </span>darkMode: 'class',</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- PptxGenJS --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Markdown Parser --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;900&amp;display=swap');</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>:root {</p>
<p class="p1"><span class="Apple-converted-space">            </span>--brand-primary: #94a3b8;</p>
<p class="p1"><span class="Apple-converted-space">            </span>--brand-secondary: #4F46E5;</p>
<p class="p1"><span class="Apple-converted-space">            </span>--brand-accent: #F59E0B;</p>
<p class="p1"><span class="Apple-converted-space">            </span>--brand-neutral: #F3F4F6;</p>
<p class="p1"><span class="Apple-converted-space">            </span>--brand-dark: #111827;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>body {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>font-family: 'Poppins', sans-serif;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>/* Mesh Gradient Background */</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #f3f4f6;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-image:<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>radial-gradient(at 0% 0%, hsla(205, 78%, 85%, 1) 0, transparent 50%),<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>radial-gradient(at 100% 0%, hsla(268, 67%, 88%, 1) 0, transparent 50%),</p>
<p class="p1"><span class="Apple-converted-space">                </span>radial-gradient(at 100% 100%, hsla(240, 67%, 94%, 1) 0, transparent 50%);</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-attachment: fixed;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-size: cover;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #2e2e2e;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: background-color 0.3s, color 0.3s;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Dynamic Theme Classes */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.text-theme-primary { color: var(--brand-primary); }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.bg-theme-primary { background-color: var(--brand-primary); }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.border-theme-primary { border-color: var(--brand-primary); }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.hover-bg-theme-primary:hover { background-color: var(--brand-primary); filter: brightness(90%); }</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Glassmorphism Card Style */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.card {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(255, 255, 255, 0.75);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>backdrop-filter: blur(16px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>-webkit-backdrop-filter: blur(16px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid rgba(255, 255, 255, 0.6);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 1.5rem; /* Rounded 3xl */</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow:<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>0 10px 25px -5px rgba(0, 0, 0, 0.05),<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>0 8px 10px -6px rgba(0, 0, 0, 0.01),</p>
<p class="p1"><span class="Apple-converted-space">                </span>inset 0 0 0 1px rgba(255,255,255,0.5);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: transform 0.2s, box-shadow 0.2s, background-color 0.3s;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.card:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05), 0 10px 10px -5px rgba(0, 0, 0, 0.02);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: rgba(255,255,255,0.9);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Dynamic Stylized Section Headers */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.section-header {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.85rem;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: 800;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>text-transform: uppercase;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>letter-spacing: 0.1em;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>color: var(--brand-primary);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-bottom: 1.25rem;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>border-bottom: 2px solid rgba(0,0,0,0.03);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>padding-bottom: 0.75rem;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: space-between;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>text-shadow: 0 1px 0 rgba(255,255,255,0.8);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.input-label { display: block; font-size: 0.75rem; font-weight: 700; color: #475569; margin-bottom: 0.35rem; letter-spacing: 0.02em; }</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Glass Inputs */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.input-field {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 0.7rem;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(255, 255, 255, 0.6);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid rgba(0,0,0,0.08);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 0.75rem;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.875rem;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.2s;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.input-field:focus {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(255, 255, 255, 1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>outline: none;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: var(--brand-primary);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.5), 0 0 0 2px var(--brand-primary);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.textarea-field {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 0.7rem;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(255, 255, 255, 0.6);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid rgba(0,0,0,0.08);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 0.75rem;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.875rem;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: all 0.2s;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>min-height: 80px;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.textarea-field:focus {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(255, 255, 255, 1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>outline: none;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: var(--brand-primary);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 0 0 4px rgba(255, 255, 255, 0.5), 0 0 0 2px var(--brand-primary);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Toggle Switch Styling */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.toggle-checkbox:checked { right: 0; border-color: var(--brand-primary); }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.toggle-checkbox:checked + .toggle-label { background-color: var(--brand-primary); }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Upload Zones for Data Hub */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.upload-zone {</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 2px dashed #cbd5e1; border-radius: 0.75rem; padding: 1rem; text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(255,255,255,0.5); transition: all 0.2s; cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.upload-zone:hover { border-color: var(--brand-primary); background: rgba(255,255,255,0.8); }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Animations */</p>
<p class="p1"><span class="Apple-converted-space">        </span>@keyframes pulse-ring {</p>
<p class="p1"><span class="Apple-converted-space">            </span>0% { box-shadow: 0 0 0 0 rgba(var(--brand-primary), 0.7); }</p>
<p class="p1"><span class="Apple-converted-space">            </span>70% { box-shadow: 0 0 0 6px rgba(var(--brand-primary), 0); }</p>
<p class="p1"><span class="Apple-converted-space">            </span>100% { box-shadow: 0 0 0 0 rgba(var(--brand-primary), 0); }</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>.ai-loading { animation: pulse-ring 1.5s cubic-bezier(0.215, 0.61, 0.355, 1) infinite; }</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>.modal { transition: opacity 0.25s ease; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>body.modal-active { overflow-x: hidden; overflow-y: visible !important; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.prose h1, .prose h2, .prose h3 { font-size: 0.9rem; font-weight: 700; color: #1e293b; margin-top: 0.75rem; margin-bottom: 0.25rem; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.prose ul { list-style-type: disc; padding-left: 1rem; margin-bottom: 0.5rem; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.prose li { margin-bottom: 0.1rem; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.prose strong { color: var(--brand-primary); }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* --- STATUS BADGES (Legacy Module) --- */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.status-completed { background-color: #d1fae5; color: #065f46; border: 1px solid #a7f3d0; font-weight: 600; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.status-progress { background-color: #dbeafe; color: #1e40af; border: 1px solid #bfdbfe; font-weight: 600; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.status-blocked { background-color: #fee2e2; color: #991b1b; border: 1px solid #fecaca; font-weight: 600; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>.status-unknown { background-color: #f3f4f6; color: #4b5563; border: 1px solid #e5e7eb; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* --- DARK MODE OVERRIDES --- */</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark body {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #0f172a;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-image:<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>radial-gradient(at 0% 0%, hsla(220, 40%, 20%, 1) 0, transparent 50%),<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>radial-gradient(at 100% 0%, hsla(260, 40%, 25%, 1) 0, transparent 50%),</p>
<p class="p1"><span class="Apple-converted-space">                </span>radial-gradient(at 100% 100%, hsla(240, 40%, 20%, 1) 0, transparent 50%);</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #f3f4f6;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .card {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(30, 41, 59, 0.6);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: rgba(255, 255, 255, 0.1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .section-header {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: var(--brand-primary);</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-shadow: none;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-bottom-color: rgba(255,255,255,0.1);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .text-gray-900 { color: #f3f4f6 !important; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .text-gray-800 { color: #e2e8f0 !important; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .text-gray-700 { color: #cbd5e1 !important; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .text-gray-600 { color: #94a3b8 !important; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .text-gray-500 { color: #cbd5e1 !important; } /* Lighten gray-500 for readability */</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .bg-gray-100 { background-color: rgba(255,255,255,0.1) !important; color: #f3f4f6 !important; border-color: transparent; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .bg-gray-50 { background-color: rgba(255,255,255,0.05) !important; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .bg-white { background-color: #1e293b !important; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .bg-white\/40 { background-color: rgba(30, 41, 59, 0.4) !important; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .bg-white\/60 { background-color: rgba(30, 41, 59, 0.6) !important; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .bg-white\/80 { background-color: rgba(30, 41, 59, 0.8) !important; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .input-field, html.dark .textarea-field {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(15, 23, 42, 0.6);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: rgba(255,255,255,0.1);</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #f3f4f6;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .input-field:focus, html.dark .textarea-field:focus {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: rgba(15, 23, 42, 0.9);</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-color: var(--brand-primary);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .input-label { color: #cbd5e1; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .border-gray-200, html.dark .border-gray-300 { border-color: rgba(255,255,255,0.1); }</p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Modal dark fixes */</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .modal-container { background-color: #1e293b; color: #f3f4f6; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* Status Dark Mode */</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .status-completed { background-color: rgba(6, 95, 70, 0.5); color: #d1fae5; border-color: #065f46; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .status-progress { background-color: rgba(30, 64, 175, 0.5); color: #dbeafe; border-color: #1e40af; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .status-blocked { background-color: rgba(153, 27, 27, 0.5); color: #fee2e2; border-color: #991b1b; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>html.dark .status-unknown { background-color: rgba(55, 65, 81, 0.5); color: #e5e7eb; border-color: #374151; }</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body class="min-h-screen pb-20"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Top Nav (Glass) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;nav class="sticky top-0 z-50 border-b border-white/30 dark:border-gray-700 bg-white/85 dark:bg-slate-900/85 backdrop-blur-xl transition-colors duration-300"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="flex justify-between h-16"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Minimalist Bear Icon (Updated to be more bear-like) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;svg class="w-9 h-9 mr-3 text-theme-primary" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;circle cx="12" cy="12" r="10" /&gt; &lt;!-- Outer Circle --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Head Contour --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;path d="M7 9 C 5 6, 2 9, 4.5 11.5 C 4 16, 9 18, 12 18 C 15 18, 20 16, 19.5 11.5 C 22 9, 19 6, 17 9" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;path d="M10 9 C 10 9, 14 9, 14 9" opacity="0"/&gt; &lt;!-- spacer --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Snout --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;ellipse cx="12" cy="13.5" rx="3" ry="2.2" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Nose --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;path d="M11 13 h2 q-1 1 -2 0" fill="currentColor" stroke="none" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Mouth --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;path d="M12 13.5 v1 q-0.8 0.8 -1.2 0 m 1.2 0 q 0.8 0.8 1.2 0" stroke-width="1.5" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Eyes --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;circle cx="9" cy="11" r="0.8" fill="currentColor" stroke="none" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;circle cx="15" cy="11" r="0.8" fill="currentColor" stroke="none" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span class="text-2xl font-black tracking-tight text-gray-900"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>QBeaR: &lt;span class="text-theme-primary"&gt;QBR Assist&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/span&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span class="ml-4 px-3 py-1 bg-gradient-to-r from-blue-500 to-purple-600 text-white text-[10px] font-bold uppercase tracking-widest rounded-full shadow-sm"&gt;Gemini Powered&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex items-center space-x-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Dark Mode Toggle --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="toggleDarkMode()" class="p-2 rounded-full hover:bg-gray-100 transition text-gray-600 dark:text-gray-300 dark:hover:bg-gray-700" title="Toggle Dark Mode"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Sun Icon (Hidden in Dark Mode) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;svg class="w-5 h-5 block dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Moon Icon (Hidden in Light Mode) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;svg class="w-5 h-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="toggleConfigModal()" class="text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white flex items-center text-xs font-bold border border-gray-200 dark:border-gray-600 rounded-xl px-4 py-2 bg-white/60 dark:bg-slate-700/60 hover:bg-white dark:hover:bg-slate-700 transition shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"&gt;&lt;/path&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>AI Config</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="text-xs text-right hidden sm:block border-l border-gray-300 pl-4 ml-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="font-bold text-gray-800"&gt;User: Beary Busy&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-gray-500 font-medium"&gt;Covered CS&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/nav&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="grid grid-cols-1 lg:grid-cols-12 gap-8"&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- LEFT COLUMN: Configuration (4 cols) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="lg:col-span-4 space-y-6"&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- 1. Client Profile --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="card p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="section-header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>Client Configuration</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button onclick="toggleSection('sectClient', this)" class="text-gray-400 hover:text-[var(--brand-primary)] transition-transform p-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="sectClient" class="space-y-4 transition-all duration-300"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="input-label"&gt;Client Name&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="text" id="clientName" class="input-field focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" value="Acme Corp"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="input-label"&gt;Client Logo (.png)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center justify-center w-full mt-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label for="logoInput" class="flex flex-col items-center justify-center w-full h-28 border-2 border-gray-300 border-dashed rounded-xl cursor-pointer bg-white/40 hover:bg-white/80 transition hover:border-[var(--brand-primary)] group relative overflow-hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div id="logoPlaceholder" class="flex flex-col items-center justify-center pt-5 pb-6 transition-opacity"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;svg class="w-8 h-8 mb-2 text-gray-300 group-hover:text-[var(--brand-primary)] transition-colors" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;p class="text-[10px] text-gray-500 font-medium group-hover:text-[var(--brand-primary)]"&gt;Upload PNG&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;img id="logoPreview" class="hidden absolute inset-0 w-full h-full object-contain p-4 transition-opacity" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input id="logoInput" type="file" class="hidden" accept="image/png" onchange="handleLogoUpload(this)" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Logo Controls --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center justify-between mt-3 bg-white/40 p-2 rounded-lg border border-white/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p id="logoStatus" class="text-[10px] text-green-600 hidden font-bold tracking-wide flex items-center"&gt;&lt;span class="w-2 h-2 rounded-full bg-green-500 mr-1.5"&gt;&lt;/span&gt;LOADED&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label class="text-[9px] text-gray-500 font-bold uppercase"&gt;Size&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="range" id="logoScale" min="0.2" max="2.0" step="0.1" value="0.8" class="w-24 h-1 bg-gray-300 rounded-lg appearance-none cursor-pointer accent-[var(--brand-primary)]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- 2. Brand Guidelines (Semantic) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="card p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="section-header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>Brand Guidelines</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button onclick="document.getElementById('brandAssetInput').click()" class="text-[10px] bg-purple-50 text-purple-700 font-bold px-3 py-1.5 rounded-lg border border-purple-100 hover:bg-purple-100 shadow-sm transition flex items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>Auto-Detect</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button onclick="toggleSection('sectBrand', this)" class="text-gray-400 hover:text-[var(--brand-primary)] transition-transform p-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="file" id="brandAssetInput" class="hidden" accept="image/*,.pdf" onchange="analyzeBrandColors(this)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="sectBrand" class="space-y-3 transition-all duration-300"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Colors --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="space-y-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center space-x-3 p-1.5 bg-white/40 rounded-lg border border-white/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="color" id="colPrimary" value="#94a3b8" class="w-8 h-8 rounded-lg border border-gray-200 cursor-pointer shadow-sm" oninput="updateTheme(this, 'hexPrimary', '--brand-primary')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="text" id="hexPrimary" value="#94a3b8" class="input-field text-[10px] h-8 w-20 font-mono text-center tracking-wide" oninput="updateTheme(this, 'colPrimary', '--brand-primary')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex-1"&gt;&lt;label class="text-[10px] font-black uppercase text-gray-700 block"&gt;Primary&lt;/label&gt;&lt;p class="text-[9px] text-gray-400"&gt;Headlines&lt;/p&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center space-x-3 p-1.5 bg-white/40 rounded-lg border border-white/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="color" id="colSecondary" value="#4F46E5" class="w-8 h-8 rounded-lg border border-gray-200 cursor-pointer shadow-sm" oninput="updateTheme(this, 'hexSecondary', '--brand-secondary')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="text" id="hexSecondary" value="#4F46E5" class="input-field text-[10px] h-8 w-20 font-mono text-center tracking-wide" oninput="updateTheme(this, 'colSecondary', '--brand-secondary')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex-1"&gt;&lt;label class="text-[10px] font-black uppercase text-gray-700 block"&gt;Secondary&lt;/label&gt;&lt;p class="text-[9px] text-gray-400"&gt;Sub-headers&lt;/p&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center space-x-3 p-1.5 bg-white/40 rounded-lg border border-white/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="color" id="colAccent" value="#F59E0B" class="w-8 h-8 rounded-lg border border-gray-200 cursor-pointer shadow-sm" oninput="updateTheme(this, 'hexAccent', '--brand-accent')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="text" id="hexAccent" value="#F59E0B" class="input-field text-[10px] h-8 w-20 font-mono text-center tracking-wide" oninput="updateTheme(this, 'colAccent', '--brand-accent')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex-1"&gt;&lt;label class="text-[10px] font-black uppercase text-gray-700 block"&gt;Accent&lt;/label&gt;&lt;p class="text-[9px] text-gray-400"&gt;CTAs/Highlights&lt;/p&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center space-x-3 p-1.5 bg-white/40 rounded-lg border border-white/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="color" id="colNeutral" value="#F3F4F6" class="w-8 h-8 rounded-lg border border-gray-200 cursor-pointer shadow-sm" oninput="updateTheme(this, 'hexNeutral', '--brand-neutral')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="text" id="hexNeutral" value="#F3F4F6" class="input-field text-[10px] h-8 w-20 font-mono text-center tracking-wide" oninput="updateTheme(this, 'colNeutral', '--brand-neutral')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex-1"&gt;&lt;label class="text-[10px] font-black uppercase text-gray-700 block"&gt;Neutral&lt;/label&gt;&lt;p class="text-[9px] text-gray-400"&gt;Backgrounds&lt;/p&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center space-x-3 p-1.5 bg-white/40 rounded-lg border border-white/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="color" id="colDark" value="#111827" class="w-8 h-8 rounded-lg border border-gray-200 cursor-pointer shadow-sm" oninput="updateTheme(this, 'hexDark', '--brand-dark')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="text" id="hexDark" value="#111827" class="input-field text-[10px] h-8 w-20 font-mono text-center tracking-wide" oninput="updateTheme(this, 'colDark', '--brand-dark')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex-1"&gt;&lt;label class="text-[10px] font-black uppercase text-gray-700 block"&gt;Dark&lt;/label&gt;&lt;p class="text-[9px] text-gray-400"&gt;Body Text&lt;/p&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- 3. Data Sources Hub (New Module) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="card p-6 border-l-4 border-[var(--brand-primary)]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="section-header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>Data Sources Hub</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button onclick="toggleSection('sectData', this)" class="text-gray-400 hover:text-[var(--brand-primary)] transition-transform p-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="sectData" class="space-y-3 transition-all duration-300"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Contract --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="bg-white/60 rounded-xl border border-white/50 p-4 shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex justify-between items-center mb-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-xs font-bold text-gray-700 flex items-center"&gt;&lt;span class="bg-blue-100 p-1 rounded mr-2"&gt;📄&lt;/span&gt; Contract / SOW&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button onclick="analyzeFile('contract')" class="text-[10px] bg-blue-50 text-blue-600 px-2 py-1 rounded hover:bg-blue-100 font-bold"&gt;✨ Analyze&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="upload-zone py-4 block hover:border-[var(--brand-primary)]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="file" id="fileContract" class="hidden" accept=".pdf" onchange="updateFileStatus(this, 'statusContract')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-[10px] text-gray-500 font-medium" id="statusContract"&gt;Drag &amp; Drop PDF&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Gainsight --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="bg-white/60 rounded-xl border border-white/50 p-4 shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex justify-between items-center mb-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-xs font-bold text-gray-700 flex items-center"&gt;&lt;span class="bg-green-100 p-1 rounded mr-2"&gt;📈&lt;/span&gt; Gainsight/Tableau&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button onclick="analyzeFile('gainsight')" class="text-[10px] bg-green-50 text-green-600 px-2 py-1 rounded hover:bg-green-100 font-bold"&gt;✨ Analyze&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="upload-zone py-4 block hover:border-[var(--brand-primary)]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="file" id="fileGainsight" class="hidden" accept="image/*" onchange="updateFileStatus(this, 'statusGainsight')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-[10px] text-gray-500 font-medium" id="statusGainsight"&gt;Drag &amp; Drop Screenshot&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Prev QBR --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="bg-white/60 rounded-xl border border-white/50 p-4 shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex justify-between items-center mb-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-xs font-bold text-gray-700 flex items-center"&gt;&lt;span class="bg-amber-100 p-1 rounded mr-2"&gt;⏮️&lt;/span&gt; Prev. QBR Deck&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button onclick="analyzeFile('prevQbr')" class="text-[10px] bg-amber-50 text-amber-600 px-2 py-1 rounded hover:bg-amber-100 font-bold"&gt;✨ Analyze&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="upload-zone py-4 block hover:border-[var(--brand-primary)]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="file" id="filePrevQbr" class="hidden" accept=".pdf,.pptx" onchange="updateFileStatus(this, 'statusPrevQbr')"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-[10px] text-gray-500 font-medium" id="statusPrevQbr"&gt;Drag &amp; Drop PDF&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div id="prevQbrOutput" class="hidden mt-2 p-2 bg-amber-50 rounded text-[10px] text-amber-800 border border-amber-100"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- 10-K --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="bg-white/60 rounded-xl border border-white/50 p-4 shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex justify-between items-center mb-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-xs font-bold text-gray-700 flex items-center"&gt;&lt;span class="bg-purple-100 p-1 rounded mr-2"&gt;🏛️&lt;/span&gt; 10-K / Strategy&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button onclick="analyzeFile('10k')" class="text-[10px] bg-purple-50 text-purple-600 px-2 py-1 rounded hover:bg-purple-100 font-bold"&gt;✨ Analyze&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex space-x-2 mb-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="text" id="manualTicker" class="input-field py-1.5 text-xs font-mono uppercase focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" placeholder="Enter Ticker (e.g. XM)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="financialOutput" class="hidden mt-2 p-2 bg-purple-50 rounded text-[10px] text-purple-800 border border-purple-100 max-h-32 overflow-y-auto"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- System Log --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="bg-slate-800 text-slate-300 p-4 rounded-xl text-xs font-mono shadow-inner border border-slate-700"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="uppercase tracking-widest text-[10px] text-slate-500 font-bold mb-2"&gt;System Log&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="simLog" class="h-24 overflow-y-auto space-y-1 scrollbar-thin scrollbar-thumb-slate-600"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="text-slate-500"&gt;Waiting for data inputs...&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- ACTION BUTTONS --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Preview Studio --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="togglePreview()" class="w-full bg-theme-primary hover-bg-theme-primary text-white px-4 py-4 rounded-xl shadow-xl hover:shadow-2xl text-sm font-bold uppercase tracking-widest transition-all flex items-center justify-center transform hover:-translate-y-0.5 border-t border-white/20"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"&gt;&lt;/path&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>Live Preview Studio</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Generate Standard --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="generateFinalDeck()" class="w-full bg-white border border-gray-200 hover:bg-gray-50 text-gray-700 px-4 py-3.5 rounded-xl shadow-sm hover:shadow-md text-sm font-bold tracking-wide transition-all flex items-center justify-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>Download PPTX (Standard)</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/button&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Prompt Export (Moved Up) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button onclick="generateCanvasPrompt()" class="w-full bg-gray-800 hover:bg-gray-900 text-white px-4 py-3 rounded-xl shadow-md text-sm font-medium flex items-center justify-center transition-colors"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>Copy Prompt for Google Gemini</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;!-- Google Slides --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="googleAuthContainer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button onclick="simulateGoogleAuth()" class="w-full bg-[#fbbc04] hover:bg-[#e3aa00] text-white px-4 py-4 rounded-xl shadow-lg hover:shadow-xl text-sm font-bold uppercase tracking-widest transition-transform transform hover:-translate-y-0.5 flex items-center justify-center text-gray-900 border-2 border-yellow-500/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24"&gt;&lt;path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-13h2v6h-2zm0 8h2v2h-2z"/&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span&gt;Connect to Google Slides&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="googleExportContainer" class="hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button onclick="generateAiDeck()" id="btnAiDeck" class="w-full bg-[#1a73e8] hover:bg-blue-700 text-white px-4 py-4 rounded-xl shadow-lg hover:shadow-xl text-sm font-bold uppercase tracking-widest transition-transform transform hover:-translate-y-0.5 flex items-center justify-center border-t border-white/20"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span&gt;Export to Slides (AI Agent)&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-[10px] text-center text-green-700 mt-2 font-bold tracking-widest flex items-center justify-center bg-green-50/80 py-1.5 rounded-full border border-green-100 backdrop-blur-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;span class="w-2 h-2 rounded-full bg-green-500 mr-2 animate-pulse"&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>CONNECTED: BEARY.BUSY@QUALTRICS.COM</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- RIGHT COLUMN: Module Repository --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="lg:col-span-8 space-y-6"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- 1. Strategic Pre-Read (Top Position) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="card p-6 border-l-4 border-[var(--brand-primary)]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="section-header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="flex items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>Strategic Pre-Read</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button onclick="togglePreReadModal()" class="text-[10px] font-bold text-[var(--brand-primary)] hover:text-[var(--brand-primary)] bg-gray-50 px-3 py-1.5 rounded-lg border border-gray-200 transition flex items-center uppercase tracking-wide"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;svg class="w-3 h-3 mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>Expand</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button onclick="toggleSection('sectPreRead', this)" class="text-gray-400 hover:text-[var(--brand-primary)] transition-transform p-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="sectPreRead" class="space-y-4 transition-all duration-300"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-xs text-gray-500 font-medium"&gt;Generate a briefing on client business goals and recent news using Gemini &amp; Google Search.&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button onclick="generatePreRead()" id="btnPreRead" class="w-full bg-white hover:bg-gray-50 text-[var(--brand-primary)] border border-[var(--brand-primary)] text-xs font-bold py-3 px-3 rounded-xl shadow-sm flex items-center justify-center transition-all uppercase tracking-wide"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>Generate Business Summary</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="preReadOutput" class="hidden h-56 overflow-y-auto text-sm text-gray-700 bg-white/50 p-5 rounded-xl border border-gray-200 prose prose-sm shadow-inner backdrop-blur-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Gemini content --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- SECTION 1: AI POWERED INSIGHTS --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="card p-6 border-l-4 border-[var(--brand-primary)]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="section-header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="flex items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>Previous QBR Followup (Vision Analysis)</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button onclick="toggleSection('sectLegacy', this)" class="text-gray-400 hover:text-[var(--brand-primary)] transition-transform p-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/h2&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="sectLegacy" class="border border-gray-200 bg-white/40 rounded-xl p-5 hover:bg-white/60 transition-colors"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="flex items-center justify-between mb-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;h3 class="text-sm font-bold text-gray-900"&gt;Previous QBR Followup Analysis&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-xs text-gray-500 mt-1"&gt;Extracts "Action Items" from uploaded Slide/Image&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;label class="inline-flex relative items-center cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="checkbox" id="toggleModLegacy" class="sr-only peer" onchange="toggleModule('modLegacyInput', this.checked)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="w-12 h-7 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:bg-[var(--brand-primary)] transition-all peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all shadow-inner"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div id="modLegacyInput" class="hidden pl-0 border-t border-purple-200 pt-4 mt-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex space-x-3 mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input id="legacyFileInput" type="file" accept="image/*,.pdf" class="block w-full text-xs text-slate-500 file:mr-4 file:py-2.5 file:px-4 file:rounded-lg file:border-0 file:text-xs file:font-bold file:uppercase file:bg-purple-100 file:text-purple-700 hover:file:bg-purple-200 cursor-pointer"/&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button onclick="generateAiLegacyAnalysis()" class="bg-purple-600 text-white px-5 py-2.5 rounded-lg text-xs font-bold uppercase tracking-wide hover:bg-purple-700 whitespace-nowrap shadow-md transition-transform hover:-translate-y-0.5"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>Analyze File</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Results Container --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div id="geminiResults" class="hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-[10px] font-black text-gray-400 mb-2 uppercase tracking-wider"&gt;Extracted Commitments (Gemini 2.5)&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="bg-white/80 rounded-xl border border-gray-200 overflow-hidden shadow-sm backdrop-blur-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="grid grid-cols-3 gap-2 bg-gray-50/80 p-3 text-xs font-bold text-gray-700 border-b"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;div class="col-span-2"&gt;Promise&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;div&gt;Status&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div id="legacyTableBody"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;!-- Dynamic Content --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Usage Intelligence (ROI) - Moved Back to Right Column --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="card p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="section-header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>Usage Intelligence (ROI)</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="flex items-center space-x-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;span class="text-[9px] font-extrabold bg-gray-100 text-gray-500 px-2 py-1 rounded-lg uppercase tracking-wider border border-gray-200"&gt;Data Source: SQL&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button onclick="toggleSection('sectROI', this)" class="text-gray-400 hover:text-[var(--brand-primary)] transition-transform p-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/h2&gt;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="sectROI" class="transition-all duration-300"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="grid grid-cols-2 md:grid-cols-3 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- MAU --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="bg-white/40 p-2 rounded-lg border border-white/50 flex flex-col justify-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="checkMau" class="mr-2 h-3.5 w-3.5 accent-[var(--brand-primary)] text-[var(--brand-primary)] rounded border-gray-300 focus:ring-[var(--brand-primary)]" checked&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label for="checkMau" class="text-[9px] font-bold text-gray-600 uppercase block cursor-pointer"&gt;MAU Growth&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="number" id="mauGrowth" class="bg-transparent border-b border-gray-300 w-full text-xs font-semibold focus:outline-none focus:border-[var(--brand-primary)]" value="-12"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Hours Saved --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="bg-white/40 p-2 rounded-lg border border-white/50 flex flex-col justify-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="checkHours" class="mr-2 h-3.5 w-3.5 accent-[var(--brand-primary)] text-[var(--brand-primary)] rounded border-gray-300 focus:ring-[var(--brand-primary)]" checked&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label for="checkHours" class="text-[9px] font-bold text-gray-600 uppercase block cursor-pointer"&gt;Hours Saved&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="number" id="timeSaved" class="bg-transparent border-b border-gray-300 w-full text-xs font-semibold focus:outline-none focus:border-[var(--brand-primary)]" value="140"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Tickets --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="bg-white/40 p-2 rounded-lg border border-white/50 flex flex-col justify-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="checkTickets" class="mr-2 h-3.5 w-3.5 accent-[var(--brand-primary)] text-[var(--brand-primary)] rounded border-gray-300 focus:ring-[var(--brand-primary)]" checked&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label for="checkTickets" class="text-[9px] font-bold text-gray-600 uppercase block cursor-pointer"&gt;Tickets Closed&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="number" id="ticketsResolved" class="bg-transparent border-b border-gray-300 w-full text-xs font-semibold focus:outline-none focus:border-[var(--brand-primary)]" value="230"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Distributions --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="bg-white/40 p-2 rounded-lg border border-white/50 flex flex-col justify-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="checkDistros" class="mr-2 h-3.5 w-3.5 accent-[var(--brand-primary)] text-[var(--brand-primary)] rounded border-gray-300 focus:ring-[var(--brand-primary)]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label for="checkDistros" class="text-[9px] font-bold text-gray-600 uppercase block cursor-pointer"&gt;Distributions Sent&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="number" id="distributionsSent" class="bg-transparent border-b border-gray-300 w-full text-xs font-semibold focus:outline-none focus:border-[var(--brand-primary)]" value="15000"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Workflows --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="bg-white/40 p-2 rounded-lg border border-white/50 flex flex-col justify-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="checkWorkflows" class="mr-2 h-3.5 w-3.5 accent-[var(--brand-primary)] text-[var(--brand-primary)] rounded border-gray-300 focus:ring-[var(--brand-primary)]" checked&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label for="checkWorkflows" class="text-[9px] font-bold text-gray-600 uppercase block cursor-pointer"&gt;Workflows Run&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="number" id="workflowsTriggered" class="bg-transparent border-b border-gray-300 w-full text-xs font-semibold focus:outline-none focus:border-[var(--brand-primary)]" value="4500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Unique Viewers --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="bg-white/40 p-2 rounded-lg border border-white/50 flex flex-col justify-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="checkViewers" class="mr-2 h-3.5 w-3.5 accent-[var(--brand-primary)] text-[var(--brand-primary)] rounded border-gray-300 focus:ring-[var(--brand-primary)]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label for="checkViewers" class="text-[9px] font-bold text-gray-600 uppercase block cursor-pointer"&gt;Unique Viewers&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="number" id="uniqueViewers" class="bg-transparent border-b border-gray-300 w-full text-xs font-semibold focus:outline-none focus:border-[var(--brand-primary)]" value="158"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Action Plans --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="bg-white/40 p-2 rounded-lg border border-white/50 flex flex-col justify-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="checkActions" class="mr-2 h-3.5 w-3.5 accent-[var(--brand-primary)] text-[var(--brand-primary)] rounded border-gray-300 focus:ring-[var(--brand-primary)]" checked&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label for="checkActions" class="text-[9px] font-bold text-gray-600 uppercase block cursor-pointer"&gt;Action Plans&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="number" id="actionPlans" class="bg-transparent border-b border-gray-300 w-full text-xs font-semibold focus:outline-none focus:border-[var(--brand-primary)]" value="13"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Response Rate --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="bg-white/40 p-2 rounded-lg border border-white/50 flex flex-col justify-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="checkResponse" class="mr-2 h-3.5 w-3.5 accent-[var(--brand-primary)] text-[var(--brand-primary)] rounded border-gray-300 focus:ring-[var(--brand-primary)]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label for="checkResponse" class="text-[9px] font-bold text-gray-600 uppercase block cursor-pointer"&gt;Resp. Rate %&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="number" id="responseRate" class="bg-transparent border-b border-gray-300 w-full text-xs font-semibold focus:outline-none focus:border-[var(--brand-primary)]" value="22"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Opt-Out Rate --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="bg-white/40 p-2 rounded-lg border border-white/50 flex flex-col justify-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="checkOptOut" class="mr-2 h-3.5 w-3.5 accent-[var(--brand-primary)] text-[var(--brand-primary)] rounded border-gray-300 focus:ring-[var(--brand-primary)]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label for="checkOptOut" class="text-[9px] font-bold text-gray-600 uppercase block cursor-pointer"&gt;Opt-Out %&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;input type="number" id="optOutRate" class="bg-transparent border-b border-gray-300 w-full text-xs font-semibold focus:outline-none focus:border-[var(--brand-primary)]" value=".5"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- AI Analysis Trigger --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="mt-6 border-t border-gray-100 pt-5"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;button id="btnAiNarrative" onclick="generateAiNarrative()" class="w-full bg-theme-primary hover-bg-theme-primary text-white text-xs font-bold uppercase tracking-widest py-3.5 px-4 rounded-xl shadow-lg hover:shadow-xl transition-all flex items-center justify-center transform hover:-translate-y-0.5"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>Analyze ROI with Gemini</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Results Container --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div id="narrativeBox" class="mt-4 p-5 bg-white/60 border border-white rounded-xl text-sm text-gray-700 hidden shadow-inner backdrop-blur-sm"&gt;&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                            </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="hidden" id="aiTheme" value=""&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="hidden" id="aiHeadline" value=""&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;input type="hidden" id="aiSummary" value=""&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- SECTION 2: STRATEGIC ADD-ONS --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="card p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="section-header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>Strategic Add-ons</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button onclick="toggleSection('sectAddons', this)" class="text-gray-400 hover:text-[var(--brand-primary)] transition-transform p-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="sectAddons" class="space-y-4 transition-all duration-300"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Module: Engagement Analysis --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="border rounded-xl p-5 bg-white/40 hover:bg-white/70 transition-all hover:shadow-md border-white/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center justify-between mb-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="bg-indigo-100 p-2.5 rounded-xl text-indigo-600 shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 3.055A9.001 9.001 0 1020.945 13H11V3.055z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div&gt;&lt;h3 class="text-sm font-bold text-gray-900"&gt;Engagement Analysis&lt;/h3&gt;&lt;p class="text-xs text-gray-500 mt-0.5"&gt;Visualize response rates &amp; NPS.&lt;/p&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label class="inline-flex relative items-center cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="toggleModEngagement" class="sr-only peer" onchange="toggleModule('modEngagementInput', this.checked)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="w-12 h-7 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:bg-[var(--brand-primary)] transition-all peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all shadow-inner"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div id="modEngagementInput" class="hidden grid grid-cols-3 gap-4 border-t border-gray-100 pt-4 mt-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;&lt;label class="input-label"&gt;Sent&lt;/label&gt;&lt;input type="number" id="modEngSent" class="input-field focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" value="1000"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;&lt;label class="input-label"&gt;Responses&lt;/label&gt;&lt;input type="number" id="modEngResp" class="input-field focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" value="250"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;&lt;label class="input-label"&gt;NPS&lt;/label&gt;&lt;input type="number" id="modEngNPS" class="input-field focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" value="45"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Module: Success Story (With Gemini) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="border rounded-xl p-5 bg-white/40 hover:bg-white/70 transition-all hover:shadow-md border-white/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center justify-between mb-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="bg-green-100 p-2.5 rounded-xl text-green-600 shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div&gt;&lt;h3 class="text-sm font-bold text-gray-900"&gt;Success Story (STAR)&lt;/h3&gt;&lt;p class="text-xs text-gray-500 mt-0.5"&gt;Qualitative win slide&lt;/p&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label class="inline-flex relative items-center cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="toggleModSuccess" class="sr-only peer" onchange="toggleModule('modSuccessInput', this.checked)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="w-12 h-7 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:bg-[var(--brand-primary)] transition-all peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all shadow-inner"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div id="modSuccessInput" class="hidden space-y-3 border-t border-gray-100 pt-4 mt-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex justify-between items-center mb-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-[10px] text-gray-400 uppercase font-bold tracking-wider"&gt;Draft your notes below&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;button id="btnAiPolish" onclick="generateAiSuccess()" class="text-[10px] bg-purple-100 text-purple-700 px-3 py-1.5 rounded-lg border border-purple-200 hover:bg-purple-200 flex items-center font-bold uppercase transition shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20"&gt;&lt;path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"/&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>Polish with Gemini</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;&lt;label class="input-label"&gt;Situation&lt;/label&gt;&lt;textarea id="modSucSit" class="textarea-field h-20 text-xs focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]"&gt;Manual exports taking 5hrs/week&lt;/textarea&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;&lt;label class="input-label"&gt;Solution&lt;/label&gt;&lt;textarea id="modSucSol" class="textarea-field h-20 text-xs focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]"&gt;Implemented Auto-Export Workflow&lt;/textarea&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;&lt;label class="input-label"&gt;Result&lt;/label&gt;&lt;textarea id="modSucRes" class="textarea-field h-20 text-xs focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]"&gt;Reduced to 0hrs, 100% accuracy&lt;/textarea&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Module: Short-Term Roadmap --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="border rounded-xl p-5 bg-white/40 hover:bg-white/70 transition-all hover:shadow-md border-white/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center justify-between mb-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="bg-blue-100 p-2.5 rounded-xl text-blue-600 shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div&gt;&lt;h3 class="text-sm font-bold text-gray-900"&gt;Short-Term Roadmap&lt;/h3&gt;&lt;p class="text-xs text-gray-500 mt-0.5"&gt;Tactical 30/60/90 Days&lt;/p&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label class="inline-flex relative items-center cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="toggleModRoadmap" class="sr-only peer" onchange="toggleModule('modRoadmapInput', this.checked)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="w-12 h-7 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:bg-[var(--brand-primary)] transition-all peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all shadow-inner"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div id="modRoadmapInput" class="hidden pl-12 space-y-3 border-t border-gray-100 pt-4 mt-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex justify-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;button id="btnAiRoadmap" onclick="generateAiRoadmap()" class="text-[10px] bg-blue-100 text-blue-700 px-3 py-1.5 rounded-lg border border-blue-200 hover:bg-blue-200 flex items-center font-bold uppercase transition shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>✨ Suggest Plan</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;&lt;label class="input-label"&gt;30 Days&lt;/label&gt;&lt;input type="text" id="modMap1" class="input-field focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" value="Core Team Training"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;&lt;label class="input-label"&gt;60 Days&lt;/label&gt;&lt;input type="text" id="modMap2" class="input-field focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" value="Integrate CRM Workflows"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;&lt;label class="input-label"&gt;90 Days&lt;/label&gt;&lt;input type="text" id="modMap3" class="input-field focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" value="Executive Review &amp; Scale"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Module: Long-Term Roadmap (NEW) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="border rounded-xl p-5 bg-white/40 hover:bg-white/70 transition-all hover:shadow-md border-white/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center justify-between mb-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="bg-blue-100 p-2.5 rounded-xl text-blue-600 shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div&gt;&lt;h3 class="text-sm font-bold text-gray-900"&gt;Long-Term Strategy&lt;/h3&gt;&lt;p class="text-xs text-gray-500 mt-0.5"&gt;Strategic 3/6/12 Months&lt;/p&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label class="inline-flex relative items-center cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="toggleModLongTerm" class="sr-only peer" onchange="toggleModule('modLongTermInput', this.checked)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="w-12 h-7 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:bg-[var(--brand-primary)] transition-all peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all shadow-inner"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div id="modLongTermInput" class="hidden pl-12 space-y-3 border-t border-gray-100 pt-4 mt-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex justify-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;button id="btnAiLongTerm" onclick="generateAiLongTermRoadmap()" class="text-[10px] bg-blue-100 text-blue-700 px-3 py-1.5 rounded-lg border border-blue-200 hover:bg-blue-200 flex items-center font-bold uppercase transition shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>✨ Suggest Strategy</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;&lt;label class="input-label"&gt;3 Months&lt;/label&gt;&lt;input type="text" id="modLong3" class="input-field focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" value="Global Expansion"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;&lt;label class="input-label"&gt;6 Months&lt;/label&gt;&lt;input type="text" id="modLong6" class="input-field focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" value="Advanced Analytics Integration"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;&lt;label class="input-label"&gt;12 Months&lt;/label&gt;&lt;input type="text" id="modLong12" class="input-field focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" value="Enterprise-Wide Adoption"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- SECTION 3: SUGGESTED SLIDES --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="card p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h2 class="section-header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>Suggested Slides</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button onclick="toggleSection('sectSlides', this)" class="text-gray-400 hover:text-[var(--brand-primary)] transition-transform p-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="sectSlides" class="space-y-4 transition-all duration-300"&gt;</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Module: Agenda (NEW) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="border rounded-xl p-5 bg-white/40 hover:bg-white/70 transition-all hover:shadow-md border-white/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center justify-between mb-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="bg-gray-100 p-2.5 rounded-xl text-gray-600 shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;h3 class="text-sm font-bold text-gray-900"&gt;Meeting Agenda&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;p class="text-xs text-gray-500 mt-0.5"&gt;Define discussion topics&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label class="inline-flex relative items-center cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="toggleModAgenda" class="sr-only peer" onchange="toggleModule('modAgendaInput', this.checked)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="w-12 h-7 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:bg-[var(--brand-primary)] transition-all peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all shadow-inner"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div id="modAgendaInput" class="hidden pl-12 border-t border-gray-100 pt-4 mt-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex justify-end mb-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;button onclick="generateAiAgenda()" id="btnAiAgenda" class="text-[10px] bg-gray-100 text-gray-700 px-3 py-1.5 rounded-lg border border-gray-200 hover:bg-gray-200 flex items-center font-bold uppercase transition shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>✨ Suggest Agenda</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label class="input-label"&gt;Agenda Items (One per line)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;textarea id="modAgendaText" class="textarea-field focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" placeholder="1. Executive Summary..."&gt;1. Executive Summary</p>
<p class="p1">2. Engagement Analysis</p>
<p class="p1">3. Strategic Roadmap</p>
<p class="p1">4. Discussion&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Module: Attendees --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="border rounded-xl p-5 bg-white/40 hover:bg-white/70 transition-all hover:shadow-md border-white/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center justify-between mb-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="bg-gray-100 p-2.5 rounded-xl text-gray-600 shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;h3 class="text-sm font-bold text-gray-900"&gt;QBR Attendees&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;p class="text-xs text-gray-500 mt-0.5"&gt;Splits into Qualtrics vs Client slides&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label class="inline-flex relative items-center cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="toggleModAttendees" class="sr-only peer" onchange="toggleModule('modAttendeesInput', this.checked)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="w-12 h-7 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:bg-[var(--brand-primary)] transition-all peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all shadow-inner"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div id="modAttendeesInput" class="hidden pl-12 border-t border-gray-100 pt-4 mt-3 grid grid-cols-2 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label class="input-label text-theme-primary"&gt;Qualtrics Team&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;textarea id="modAttQualtrics" class="textarea-field focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" placeholder="Name, Role (One per line)"&gt;Beary Busy, TSM</p>
<p class="p1">Beary White, AE</p>
<p class="p1">Sir Fluffington, TSM&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label class="input-label text-gray-700"&gt;Client Team&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;textarea id="modAttClient" class="textarea-field focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" placeholder="Name, Role (One per line)"&gt;Bearly Human, VP Product</p>
<p class="p1">Winnie DePugh, Director of CX&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;!-- Module: X4 Promotion --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="border rounded-xl p-5 bg-white/40 hover:bg-white/70 transition-all hover:shadow-md border-white/50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="flex items-center justify-between mb-0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center space-x-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="bg-pink-100 p-2.5 rounded-xl text-pink-600 shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.147-6.15M18 13a3 3 0 100-6M5.436 13.683A4.001 4.001 0 017 6h1.832c4.1 0 7.625-1.234 9.168-3v14c-1.543-1.766-5.067-3-9.168-3H7a3.988 3.988 0 01-1.564-.317z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;h3 class="text-sm font-bold text-gray-900"&gt;X4 Event Promotion&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;p class="text-xs text-gray-500 mt-0.5"&gt;Promo slide &amp; Keynotes&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label class="inline-flex relative items-center cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;input type="checkbox" id="toggleModX4" class="sr-only peer" onchange="toggleModule('modX4Input', this.checked)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="w-12 h-7 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:bg-[var(--brand-primary)] transition-all peer-checked:after:translate-x-full after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all shadow-inner"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                            </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;!-- Expanded X4 Config --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div id="modX4Input" class="hidden space-y-4 border-t border-gray-100 pt-4 mt-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;!-- Image Upload --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label class="input-label text-pink-600"&gt;Promo Slide Image (Full Screen)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label class="upload-zone py-3 block hover:border-pink-400 group cursor-pointer transition-colors border-dashed border-2 border-gray-300 rounded-lg"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;div class="flex flex-col items-center justify-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>&lt;input type="file" id="fileX4Promo" class="hidden" accept="image/*" onchange="handleX4Upload(this)"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>&lt;span id="statusX4Promo" class="text-[10px] text-gray-500 font-medium group-hover:text-pink-500 transition-colors"&gt;Click to Upload Image&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;!-- Speaker Select --&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;label class="input-label text-gray-700 mb-2"&gt;Add Keynote Slides&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="grid grid-cols-2 gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;label class="flex items-center space-x-2 p-2 rounded hover:bg-white/50 cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>&lt;input type="checkbox" class="x4-speaker-check rounded text-pink-600 focus:ring-pink-500 border-gray-300" value="Andy Cohen"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>&lt;span class="text-xs text-gray-700 font-medium"&gt;Andy Cohen&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;label class="flex items-center space-x-2 p-2 rounded hover:bg-white/50 cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>&lt;input type="checkbox" class="x4-speaker-check rounded text-pink-600 focus:ring-pink-500 border-gray-300" value="Priya Parker"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>&lt;span class="text-xs text-gray-700 font-medium"&gt;Priya Parker&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;label class="flex items-center space-x-2 p-2 rounded hover:bg-white/50 cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>&lt;input type="checkbox" class="x4-speaker-check rounded text-pink-600 focus:ring-pink-500 border-gray-300" value="Jay Shetty"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>&lt;span class="text-xs text-gray-700 font-medium"&gt;Jay Shetty&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;label class="flex items-center space-x-2 p-2 rounded hover:bg-white/50 cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>&lt;input type="checkbox" class="x4-speaker-check rounded text-pink-600 focus:ring-pink-500 border-gray-300" value="Mindy Kaling"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                            </span>&lt;span class="text-xs text-gray-700 font-medium"&gt;Mindy Kaling&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/main&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- PREVIEW STUDIO MODAL (RE-RENDERED FULL SCREEN) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="previewModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 z-[100] bg-gray-900 bg-opacity-95 flex flex-col transition-opacity duration-300 backdrop-blur-xl"&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Toolbar --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="h-16 flex justify-between items-center px-8 bg-white/5 border-b border-white/10"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="flex items-center space-x-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;span class="text-white font-black tracking-widest text-xs uppercase"&gt;Preview Studio&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;span class="bg-indigo-500 text-white text-[9px] font-bold px-2 py-0.5 rounded-full font-mono tracking-wide" id="previewSlideCount"&gt;0 SLIDES&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="flex items-center space-x-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;button onclick="generateFinalDeck()" class="bg-white text-gray-900 px-4 py-2 rounded-lg text-xs font-bold hover:bg-gray-100 flex items-center shadow-lg transition-transform hover:-translate-y-0.5"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>Download Deck</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button onclick="togglePreview()" class="text-gray-400 hover:text-white transition-colors bg-white/10 p-2 rounded-full hover:bg-white/20"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Slide Viewport --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="flex-1 flex items-center justify-center p-8 relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button onclick="changePreviewSlide(-1)" class="absolute left-8 p-4 rounded-full bg-white/5 border border-white/10 hover:bg-white/20 text-white transition-all hover:scale-105 shadow-2xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/button&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="previewCanvas" class="bg-white aspect-video w-full max-w-6xl rounded-2xl shadow-2xl overflow-hidden relative transition-all duration-500 transform scale-100 border border-gray-800"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Slide Content Injected Here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button onclick="changePreviewSlide(1)" class="absolute right-8 p-4 rounded-full bg-white/5 border border-white/10 hover:bg-white/20 text-white transition-all hover:scale-105 shadow-2xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- Footer / Dots --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="h-16 flex justify-center items-center space-x-2 bg-white/5 border-t border-white/10"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="previewDots" class="flex space-x-2"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- PRE-READ EXPANDED MODAL --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="preReadModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-[110]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50" onclick="togglePreReadModal()"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="modal-container bg-white w-11/12 md:max-w-4xl mx-auto rounded shadow-lg z-50 h-[80vh] flex flex-col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="flex justify-between items-center p-6 border-b"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;h3 class="text-xl font-bold text-gray-800"&gt;Strategic Pre-Read: Business Summary&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button onclick="togglePreReadModal()" class="text-gray-500 hover:text-gray-800"&gt;✕&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="p-8 overflow-y-auto flex-1 prose max-w-none" id="preReadModalContent"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;!-- Content injected here --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="p-4 border-t flex justify-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button onclick="togglePreReadModal()" class="bg-gray-100 text-gray-700 px-4 py-2 rounded text-sm hover:bg-gray-200"&gt;Close&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- AI CONFIG MODAL --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="configModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-[100]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">       </span>&lt;div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50" onclick="toggleConfigModal()"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="modal-content py-4 text-left px-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex justify-between items-center pb-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="text-xl font-bold"&gt;Configure AI Prompts&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="cursor-pointer z-50" onclick="toggleConfigModal()"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;svg class="fill-current text-black" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18"&gt;&lt;path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="space-y-4 text-xs"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;&lt;label class="font-bold block mb-1"&gt;Executive Narrative Prompt&lt;/label&gt;&lt;textarea id="promptNarrative" class="w-full border p-2 h-20 rounded bg-gray-50"&gt;Act as an expert Customer Success Manager. Analyze these metrics: MAU Growth {{mau}}%, Automation Usage Growth {{auto}}%, Time Saved {{hours}} hours. Output JSON with keys: "theme", "headline", "summary". Professional tone.&lt;/textarea&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;&lt;label class="font-bold block mb-1"&gt;Success Story Polisher Prompt&lt;/label&gt;&lt;textarea id="promptSuccess" class="w-full border p-2 h-20 rounded bg-gray-50"&gt;Rewrite these rough QBR notes into "STAR" format corporate speak. Do not use asterisks or bolding. Input: Situation: "{{sit}}", Solution: "{{sol}}", Result: "{{res}}". Output JSON with keys: "situation", "solution", "result".&lt;/textarea&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;&lt;label class="font-bold block mb-1"&gt;Roadmap Suggester Prompt (Short Term)&lt;/label&gt;&lt;textarea id="promptRoadmap" class="w-full border p-2 h-20 rounded bg-gray-50"&gt;Suggest a 3-phase Short-Term Customer Success Roadmap (30/60/90 days) for client with MAU Growth {{mau}}%. Output JSON with keys: "phase1", "phase2", "phase3". Keep phrases under 6 words.&lt;/textarea&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;&lt;label class="font-bold block mb-1"&gt;Previous QBR Followup Analysis Prompt&lt;/label&gt;&lt;textarea id="promptLegacy" class="w-full border p-2 h-20 rounded bg-gray-50"&gt;Analyze this image/slide. Extract "Next Steps" or "Action Items" committed to. Output JSON array of objects with keys: "promise" (string) and "status" (default to 'Unknown').&lt;/textarea&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex justify-end pt-4"&gt;&lt;button onclick="toggleConfigModal()" class="px-4 py-2 bg-brand-blue text-white rounded text-sm hover:bg-blue-600"&gt;Save Configurations&lt;/button&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- CANVAS PROMPT MODAL --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="promptModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-[110]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50" onclick="togglePromptModal()"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="modal-container bg-white dark:bg-slate-800 w-11/12 md:max-w-2xl mx-auto rounded shadow-lg z-50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="modal-content py-4 text-left px-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex justify-between items-center pb-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h3 class="text-lg font-bold text-gray-800 dark:text-white"&gt;Copy Prompt for Google Gemini&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="togglePromptModal()" class="text-gray-500 hover:text-gray-800 dark:text-gray-400 dark:hover:text-white"&gt;✕&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="bg-blue-50 dark:bg-slate-700/50 p-4 rounded-lg border border-blue-100 dark:border-slate-600 mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;ol class="list-decimal list-inside text-xs text-slate-700 dark:text-slate-300 space-y-1.5 font-medium"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;li&gt;Copy the prompt below.&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;li&gt;Paste into &lt;a href="https://gemini.google.com/app" target="_blank" class="text-blue-600 dark:text-blue-400 font-bold hover:underline"&gt;Gemini Canvas&lt;/a&gt;.&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;li&gt;Collaborate &amp; Iterate on Deck Content within Gemini.&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;li&gt;Ask Gemini to "Generate Presentation" to Export.&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/ol&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;textarea id="canvasPromptOutput" class="w-full h-48 border p-3 rounded bg-gray-50 dark:bg-slate-900 border-gray-200 dark:border-gray-700 text-xs font-mono mb-4 text-gray-800 dark:text-gray-300 focus:ring-[var(--brand-primary)] focus:border-[var(--brand-primary)]" readonly&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex justify-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="copyCanvasPrompt()" class="bg-gray-800 hover:bg-gray-900 text-white px-4 py-2 rounded text-sm font-bold transition-colors"&gt;Copy to Clipboard&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- SUCCESS MODAL (Unchanged) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="successModal" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center z-[120]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50" onclick="toggleSuccessModal()"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="modal-content py-4 text-left px-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex items-center mb-3 text-green-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"&gt;&lt;/path&gt;&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h3 class="text-xl font-bold text-gray-800"&gt;Deck Generated Successfully!&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p class="text-sm text-gray-600 mb-4"&gt;Your AI-enhanced QBR deck has been downloaded.&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="bg-blue-50 p-4 rounded border border-blue-100 mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p class="text-xs font-bold text-blue-800 mb-2 uppercase"&gt;Google Slides Integration&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;ol class="list-decimal list-inside text-xs text-blue-700 space-y-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;li&gt;File is ready for import.&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;li&gt;Click button below to open Google Slides.&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;li&gt;Select &lt;strong&gt;File &gt; Import Slides&lt;/strong&gt; and choose the downloaded file.&lt;/li&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/ol&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="flex justify-end space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;button onclick="toggleSuccessModal()" class="px-4 py-2 text-gray-500 text-sm hover:text-gray-700"&gt;Close&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;a href="https://docs.google.com/presentation/u/0/create" target="_blank" class="px-4 py-2 bg-[#fbbc04] text-gray-900 font-bold rounded text-sm hover:bg-[#f5b400] flex items-center"&gt;Open Google Slides&lt;/a&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- 0. GLOBAL STATE ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>const apiKey = ""; // Runtime provided</p>
<p class="p1"><span class="Apple-converted-space">        </span>let clientLogoData = null;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>let x4PromoData = null; // New global for X4 image</p>
<p class="p1"><span class="Apple-converted-space">        </span>let legacyFileBase64 = null;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>let legacyFileMimeType = null;</p>
<p class="p1"><span class="Apple-converted-space">        </span>let previewSlides = [];</p>
<p class="p1"><span class="Apple-converted-space">        </span>let currentPreviewIndex = 0;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- 1. UTILS ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>function toggleConfigModal() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('configModal').classList.toggle('opacity-0');</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('configModal').classList.toggle('pointer-events-none');</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.body.classList.toggle('modal-active');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>function toggleSuccessModal() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('successModal').classList.toggle('opacity-0');</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('successModal').classList.toggle('pointer-events-none');</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.body.classList.toggle('modal-active');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>function togglePromptModal() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('promptModal').classList.toggle('opacity-0');</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('promptModal').classList.toggle('pointer-events-none');</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.body.classList.toggle('modal-active');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>function togglePreReadModal() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Copy content</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('preReadModalContent').innerHTML = document.getElementById('preReadOutput').innerHTML;</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('preReadModal').classList.toggle('opacity-0');</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('preReadModal').classList.toggle('pointer-events-none');</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.body.classList.toggle('modal-active');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>function toggleDarkMode() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.documentElement.classList.toggle('dark');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function simulateGoogleAuth() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const btn = event.target.closest('button');</p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.innerHTML = `&lt;svg class="animate-spin -ml-1 mr-2 h-5 w-5 text-gray-900" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"&gt;&lt;circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"&gt;&lt;/circle&gt;&lt;path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"&gt;&lt;/path&gt;&lt;/svg&gt; Connecting...`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('googleAuthContainer').classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('googleExportContainer').classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}, 1500);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function handleLogoUpload(input) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (input.files &amp;&amp; input.files[0]) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const reader = new FileReader();</p>
<p class="p1"><span class="Apple-converted-space">                </span>reader.onload = function(e) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>clientLogoData = e.target.result;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Preview Logic</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const preview = document.getElementById('logoPreview');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const placeholder = document.getElementById('logoPlaceholder');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (preview &amp;&amp; placeholder) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>preview.src = clientLogoData;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>preview.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                        </span>placeholder.classList.add('opacity-0'); // Fade out placeholder</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('logoStatus').classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>reader.readAsDataURL(input.files[0]);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// New X4 Upload Handler</p>
<p class="p1"><span class="Apple-converted-space">        </span>function handleX4Upload(input) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (input.files &amp;&amp; input.files[0]) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const reader = new FileReader();</p>
<p class="p1"><span class="Apple-converted-space">                </span>reader.onload = function(e) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>x4PromoData = e.target.result;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const status = document.getElementById('statusX4Promo');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>status.innerText = "Image Loaded Successfully";</p>
<p class="p1"><span class="Apple-converted-space">                    </span>status.classList.add('text-green-600', 'font-bold');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>status.classList.remove('text-gray-500');</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>reader.readAsDataURL(input.files[0]);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateStatusColor(selectEl) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>selectEl.className = "text-xs border rounded p-1 ";<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const val = selectEl.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (val === "Completed") selectEl.classList.add('status-completed');</p>
<p class="p1"><span class="Apple-converted-space">            </span>else if (val === "In Progress") selectEl.classList.add('status-progress');</p>
<p class="p1"><span class="Apple-converted-space">            </span>else if (val === "Blocked") selectEl.classList.add('status-blocked');</p>
<p class="p1"><span class="Apple-converted-space">            </span>else selectEl.classList.add('status-unknown');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function toggleModule(id, isChecked) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const el = document.getElementById(id);</p>
<p class="p1"><span class="Apple-converted-space">            </span>isChecked ? el.classList.remove('hidden') : el.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- NEW: Card Collapse Logic ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>function toggleSection(id, btn) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const content = document.getElementById(id);</p>
<p class="p1"><span class="Apple-converted-space">            </span>const icon = btn.querySelector('svg');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (content.classList.contains('hidden')) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Expand</p>
<p class="p1"><span class="Apple-converted-space">                </span>content.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                </span>icon.classList.remove('rotate-180');</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Collapse</p>
<p class="p1"><span class="Apple-converted-space">                </span>content.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                </span>icon.classList.add('rotate-180');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function cleanAiText(text) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!text) return "";</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (Array.isArray(text)) return text.map(t =&gt; cleanAiText(t)).join(". ");<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (typeof text !== 'string') return String(text);</p>
<p class="p1"><span class="Apple-converted-space">            </span>return text.replace(/\*\*/g, '').replace(/##/g, '').replace(/^-\s/gm, '');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function copyCanvasPrompt() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const copyText = document.getElementById("canvasPromptOutput");</p>
<p class="p1"><span class="Apple-converted-space">            </span>copyText.select();</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.execCommand("copy");</p>
<p class="p1"><span class="Apple-converted-space">            </span>event.target.innerText = "Copied!";</p>
<p class="p1"><span class="Apple-converted-space">            </span>setTimeout(() =&gt; event.target.innerText = "Copy to Clipboard", 2000);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- DATA HUB LOGIC ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateFileStatus(input, statusId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const el = document.getElementById(statusId);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (input.files.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>el.innerText = `${input.files.length} file(s) selected`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>el.classList.add('text-green-600', 'font-bold');</p>
<p class="p1"><span class="Apple-converted-space">                </span>el.classList.remove('text-gray-500');</p>
<p class="p1"><span class="Apple-converted-space">                </span>logToSim(`File loaded: ${input.files[0].name}`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function logToSim(msg) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const log = document.getElementById('simLog');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const entry = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const time = new Date().toLocaleTimeString().split(' ')[0];</p>
<p class="p1"><span class="Apple-converted-space">            </span>entry.innerHTML = `&lt;span class="text-slate-500"&gt;[${time}]&lt;/span&gt; ${msg}`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>log.prepend(entry);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function analyzeFile(type) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const btn = event.target;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const orig = btn.innerText; btn.innerText = "⏳..."; btn.disabled = true;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>if(type === 'contract') {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Mock extraction</p>
<p class="p1"><span class="Apple-converted-space">                    </span>logToSim("Analyzing Contract PDF...");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>await new Promise(r =&gt; setTimeout(r, 800)); // Simulate delay</p>
<p class="p1"><span class="Apple-converted-space">                    </span>logToSim("&lt;span class='text-green-400'&gt;SUCCESS:&lt;/span&gt; Extracted ACV: $150,000");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>logToSim("&lt;span class='text-green-400'&gt;SUCCESS:&lt;/span&gt; Extracted Renewal: 2025-12-31");</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (type === 'gainsight') {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>logToSim("Analyzing Dashboard Screenshot...");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>await new Promise(r =&gt; setTimeout(r, 800));</p>
<p class="p1"><span class="Apple-converted-space">                    </span>logToSim("&lt;span class='text-green-400'&gt;SUCCESS:&lt;/span&gt; Health Score detected: 88");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>logToSim("&lt;span class='text-green-400'&gt;SUCCESS:&lt;/span&gt; NPS detected: 52");</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (type === 'prevQbr') {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const mockOutput = "Previous QBR Commitments: 1. Launch new survey. 2. Integrate Salesforce. 3. Enable SSO.";</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('prevQbrOutput').innerText = mockOutput;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('prevQbrOutput').classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>logToSim("&lt;span class='text-amber-400'&gt;EXTRACTED:&lt;/span&gt; Previous commitments found.");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>} else if (type === '10k') {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>logToSim("Querying Gemini API for 10-K strategy...");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const ticker = document.getElementById('manualTicker').value || "XM";</p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Using existing callGemini with search tool enabled</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const res = await callGemini(`Summarize the top 3 strategic priorities for ${ticker} from their latest 10-K or Annual Report. Keep it concise.`, null, true);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if(res) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>document.getElementById('financialOutput').innerHTML = marked.parse(res);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>document.getElementById('financialOutput').classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                        </span>logToSim("&lt;span class='text-purple-400'&gt;AI COMPLETE:&lt;/span&gt; Strategy Summary generated.");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>logToSim("&lt;span class='text-red-400'&gt;ERROR:&lt;/span&gt; AI Request failed.");</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>console.error(error);</p>
<p class="p1"><span class="Apple-converted-space">                </span>logToSim("Error during analysis.");</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.innerText = orig; btn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- NEW HELPER FOR ROI GRID ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>function getCheckedMetrics() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const metrics = [];</p>
<p class="p1"><span class="Apple-converted-space">            </span>// Safe helper to check existence in case DOM isn't ready or changed</p>
<p class="p1"><span class="Apple-converted-space">            </span>const getVal = (id) =&gt; document.getElementById(id) ? document.getElementById(id).value : '0';</p>
<p class="p1"><span class="Apple-converted-space">            </span>const isChecked = (id) =&gt; document.getElementById(id) &amp;&amp; document.getElementById(id).checked;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if(isChecked('checkMau')) metrics.push(`MAU Growth: ${getVal('mauGrowth')}%`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(isChecked('checkHours')) metrics.push(`Hours Saved: ${getVal('timeSaved')}`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(isChecked('checkTickets')) metrics.push(`Tickets Resolved: ${getVal('ticketsResolved')}`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(isChecked('checkDistros')) metrics.push(`Distributions: ${getVal('distributionsSent')}`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(isChecked('checkWorkflows')) metrics.push(`Workflows Triggered: ${getVal('workflowsTriggered')}`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(isChecked('checkViewers')) metrics.push(`Unique Viewers: ${getVal('uniqueViewers')}`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(isChecked('checkActions')) metrics.push(`Action Plans: ${getVal('actionPlans')}`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(isChecked('checkResponse')) metrics.push(`Response Rate: ${getVal('responseRate')}%`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(isChecked('checkOptOut')) metrics.push(`Opt-Out Rate: ${getVal('optOutRate')}%`);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>return metrics.join(', ');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// Color Sync &amp; Dynamic Theme Application</p>
<p class="p1"><span class="Apple-converted-space">        </span>function syncHex(colorInput, textId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById(textId).value = colorInput.value.toUpperCase();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>function syncColor(textInput, colorId) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(textInput.value.match(/^#[0-9A-F]{6}$/i)) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById(colorId).value = textInput.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateTheme(input, targetId, cssVar) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// 1. Sync Inputs</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(input.type === 'color') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>syncHex(input, targetId);</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Update CSS Variable</p>
<p class="p1"><span class="Apple-converted-space">                </span>document.documentElement.style.setProperty(cssVar, input.value);</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>syncColor(input, targetId);</p>
<p class="p1"><span class="Apple-converted-space">                </span>if(input.value.match(/^#[0-9A-F]{6}$/i)) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.documentElement.style.setProperty(cssVar, input.value);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- 2. GEMINI API CLIENT ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>async function callGemini(prompt, inlineData = null, useSearch = false) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const payload = { contents: [{ parts: [{ text: prompt }] }] };</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (inlineData) payload.contents[0].parts.push({ inline_data: { mime_type: inlineData.mimeType, data: inlineData.data } });</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (useSearch) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>payload.tools = [{ google_search: {} }];</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const response = await fetch(url, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (!response.ok) throw new Error(`API Error: ${response.status}`);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const data = await response.json();</p>
<p class="p1"><span class="Apple-converted-space">                </span>let text = data.candidates[0].content.parts[0].text;</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (text.startsWith("```json")) text = text.replace(/^```json\s*/, "").replace(/\s*```$/, "");</p>
<p class="p1"><span class="Apple-converted-space">                </span>return text;</p>
<p class="p1"><span class="Apple-converted-space">            </span>} catch (error) { console.error("Gemini Error:", error); return null; }</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- 3. AI FEATURES ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>// Brand Analysis</p>
<p class="p1"><span class="Apple-converted-space">        </span>function analyzeBrandColors(input) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (input.files &amp;&amp; input.files[0]) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const file = input.files[0];</p>
<p class="p1"><span class="Apple-converted-space">                </span>const reader = new FileReader();</p>
<p class="p1"><span class="Apple-converted-space">                </span>reader.onload = async function(e) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const base64 = e.target.result.split(',')[1];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const btn = input.previousElementSibling;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const origText = btn.innerText;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>btn.innerText = "Scanning..."; btn.disabled = true;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const prompt = `Act as a Senior UI/UX Designer. Analyze the uploaded brand asset (logo, website screenshot, or document) with high sensitivity to color nuances.<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>Extract the 5 specific Hex codes that define the brand identity:</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>1. "pri" (Primary): The most dominant color in the logo or headers.</p>
<p class="p1"><span class="Apple-converted-space">                    </span>2. "sec" (Secondary): A supporting brand color. If the brand is monocolor, generate a harmonious analogous shade.</p>
<p class="p1"><span class="Apple-converted-space">                    </span>3. "acc" (Accent): A high-contrast color suitable for buttons or highlights. If missing, derive a complementary color to the Primary.</p>
<p class="p1"><span class="Apple-converted-space">                    </span>4. "neu" (Neutral): A very light background tone (e.g., off-white, light cool gray). Avoid pure white (#FFFFFF).</p>
<p class="p1"><span class="Apple-converted-space">                    </span>5. "drk" (Dark): The primary text color (e.g., charcoal, deep navy). Avoid pure black (#000000).</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>Return ONLY a JSON object with these exact keys: { "pri": "#...", "sec": "#...", "acc": "#...", "neu": "#...", "drk": "#..." }`;</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const result = await callGemini(prompt, { mimeType: file.type, data: base64 });</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>if(result) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const colors = JSON.parse(result);</p>
<p class="p1"><span class="Apple-converted-space">                            </span>if(colors.pri) {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                                </span>document.getElementById('colPrimary').value = colors.pri;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                                </span>document.getElementById('hexPrimary').value = colors.pri;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>document.documentElement.style.setProperty('--brand-primary', colors.pri);</p>
<p class="p1"><span class="Apple-converted-space">                            </span>}</p>
<p class="p1"><span class="Apple-converted-space">                            </span>if(colors.sec) { document.getElementById('colSecondary').value = colors.sec; document.getElementById('hexSecondary').value = colors.sec; }</p>
<p class="p1"><span class="Apple-converted-space">                            </span>if(colors.acc) { document.getElementById('colAccent').value = colors.acc; document.getElementById('hexAccent').value = colors.acc; }</p>
<p class="p1"><span class="Apple-converted-space">                            </span>if(colors.neu) { document.getElementById('colNeutral').value = colors.neu; document.getElementById('hexNeutral').value = colors.neu; }</p>
<p class="p1"><span class="Apple-converted-space">                            </span>if(colors.drk) { document.getElementById('colDark').value = colors.drk; document.getElementById('hexDark').value = colors.drk; }</p>
<p class="p1"><span class="Apple-converted-space">                        </span>} catch(e){ alert("Could not parse colors."); }</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>btn.innerText = origText; btn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">                </span>};</p>
<p class="p1"><span class="Apple-converted-space">                </span>reader.readAsDataURL(file);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function generatePreRead() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const btn = document.getElementById('btnPreRead');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const box = document.getElementById('preReadOutput');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const origText = btn.innerHTML;</p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.innerHTML = `Generating...`; btn.disabled = true;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const client = document.getElementById('clientName').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const prompt = `Generate a strategic pre-read for ${client}.<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>Section 1: Business Summary &amp; Recent News (Last 12 Months).<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>Section 2: Stated Business Goals &amp; Objectives.<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>Section 3: Suggested Qualtrics Solutions mapped to these goals.</p>
<p class="p1"><span class="Apple-converted-space">            </span>Keep it executive and concise. Use markdown.`;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const result = await callGemini(prompt, null, true); // useSearch = true</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (result) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>box.innerHTML = marked.parse(result);</p>
<p class="p1"><span class="Apple-converted-space">                </span>box.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.innerHTML = origText; btn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function generateAiNarrative() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const btn = document.getElementById('btnAiNarrative');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const box = document.getElementById('narrativeBox');</p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.innerHTML = `Analyzing...`; btn.disabled = true;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const metricsString = getCheckedMetrics();</p>
<p class="p1"><span class="Apple-converted-space">            </span>let prompt = `Act as a Senior Customer Success Manager. Analyze these ROI metrics: ${metricsString}.<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>Identify 2 distinct strategic themes.<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>For each theme, provide a 'headline' and a very short 'summary' (max 20 words) suitable for a single slide.</p>
<p class="p1"><span class="Apple-converted-space">            </span>CRITICAL: If any metric is negative, you MUST include a 'coaching_plan' field with a remedial action.</p>
<p class="p1"><span class="Apple-converted-space">            </span>Output JSON: { "themes": [{ "theme": "...", "headline": "...", "summary": "...", "coaching_plan": "..." }] }`;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const result = await callGemini(prompt);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (result) {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>try {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const json = JSON.parse(result);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>box.classList.remove('hidden');<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>let html = '';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if(json.themes &amp;&amp; Array.isArray(json.themes)) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>json.themes.forEach(t =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>html += `&lt;div class="mb-3 border-b border-gray-100 pb-2 last:border-0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex justify-between items-start"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span class="text-[10px] font-bold text-purple-600 uppercase tracking-wider"&gt;${cleanAiText(t.theme)}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>${t.coaching_plan ? `&lt;span class="bg-red-100 text-red-600 text-[9px] px-2 py-0.5 rounded-full font-bold"&gt;Needs Coaching&lt;/span&gt;` : ''}</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="font-bold text-gray-900 text-sm mt-1"&gt;"${cleanAiText(t.headline)}"&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="text-xs text-gray-600 mt-1"&gt;${cleanAiText(t.summary)}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>${t.coaching_plan ? `&lt;div class="mt-2 bg-red-50 p-2 rounded text-[10px] text-red-700"&gt;&lt;strong&gt;Coaching Plan:&lt;/strong&gt; ${cleanAiText(t.coaching_plan)}&lt;/div&gt;` : ''}</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>});</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>box.innerHTML = html;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>document.getElementById('aiSummary').value = JSON.stringify(json.themes);</p>
<p class="p1"><span class="Apple-converted-space">                </span>} catch (e) {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>console.error(e);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>box.innerHTML = `&lt;span class="text-red-600"&gt;Error parsing.&lt;/span&gt;`;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>}<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.innerHTML = `&lt;svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;&lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"&gt;&lt;/path&gt;&lt;/svg&gt; Analyze ROI with Gemini`;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function generateAiSuccess() { const btn = document.getElementById('btnAiPolish'); const txt = btn.innerHTML; btn.innerHTML = "✨..."; btn.disabled = true; let prompt = document.getElementById('promptSuccess').value.replace('{{sit}}', document.getElementById('modSucSit').value).replace('{{sol}}', document.getElementById('modSucSol').value).replace('{{res}}', document.getElementById('modSucRes').value); const result = await callGemini(prompt); if (result) { try { const json = JSON.parse(result); document.getElementById('modSucSit').value = cleanAiText(json.situation); document.getElementById('modSucSol').value = cleanAiText(json.solution); document.getElementById('modSucRes').value = cleanAiText(json.result); } catch(e){} } btn.innerHTML = txt; btn.disabled = false; }</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function generateAiRoadmap() {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const btn = document.getElementById('btnAiRoadmap'); const txt = btn.innerHTML; btn.innerHTML = "✨..."; btn.disabled = true;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>let prompt = document.getElementById('promptRoadmap').value.replace('{{mau}}', document.getElementById('mauGrowth').value);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const result = await callGemini(prompt);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (result) { try { const json = JSON.parse(result); document.getElementById('modMap1').value = cleanAiText(json.phase1); document.getElementById('modMap2').value = cleanAiText(json.phase2); document.getElementById('modMap3').value = cleanAiText(json.phase3); } catch(e){ console.error(e); alert("Failed to parse AI response"); } } btn.innerHTML = txt; btn.disabled = false;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function generateAiLongTermRoadmap() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const btn = document.getElementById('btnAiLongTerm'); const txt = btn.innerHTML; btn.innerHTML = "✨..."; btn.disabled = true;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let prompt = `Suggest a 3-phase Long-Term Strategic Roadmap (3 Months, 6 Months, 12 Months) for a client with MAU Growth ${document.getElementById('mauGrowth').value}%. Focus on strategic expansion. Output JSON with keys: "phase1", "phase2", "phase3". Keep phrases under 6 words.`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const result = await callGemini(prompt);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (result) { try { const json = JSON.parse(result); document.getElementById('modLong3').value = cleanAiText(json.phase1); document.getElementById('modLong6').value = cleanAiText(json.phase2); document.getElementById('modLong12').value = cleanAiText(json.phase3); } catch(e){ console.error(e); alert("Failed to parse AI response"); } } btn.innerHTML = txt; btn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function generateAiAgenda() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const btn = document.getElementById('btnAiAgenda'); const txt = btn.innerHTML; btn.innerHTML = "✨..."; btn.disabled = true;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let activeModules = [];</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModLegacy').checked) activeModules.push("Review Past Commitments");</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModEngagement').checked) activeModules.push("Engagement &amp; NPS Review");</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModSuccess').checked) activeModules.push("Strategic Wins / Success Stories");</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModRoadmap').checked || document.getElementById('toggleModLongTerm').checked) activeModules.push("Roadmap &amp; Future Planning");</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>let prompt = `Create a meeting agenda based on these topics: ${activeModules.join(', ')}. Return just a numbered list.`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const result = await callGemini(prompt);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (result) { document.getElementById('modAgendaText').value = cleanAiText(result); }</p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.innerHTML = txt; btn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>document.getElementById('legacyFileInput').addEventListener('change', function(e) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const file = e.target.files[0];</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!file) return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const reader = new FileReader();</p>
<p class="p1"><span class="Apple-converted-space">            </span>reader.onload = function(e) { legacyFileBase64 = e.target.result.split(',')[1]; legacyFileMimeType = file.type; };</p>
<p class="p1"><span class="Apple-converted-space">            </span>reader.readAsDataURL(file);</p>
<p class="p1"><span class="Apple-converted-space">        </span>});</p>
<p class="p1"><span class="Apple-converted-space">        </span>async function generateAiLegacyAnalysis() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!legacyFileBase64) { alert("Please upload a file first."); return; }</p>
<p class="p1"><span class="Apple-converted-space">            </span>const btn = event.target;</p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.innerText = "Analyzing..."; btn.disabled = true;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const prompt = document.getElementById('promptLegacy').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const inlineData = { mimeType: legacyFileMimeType, data: legacyFileBase64 };</p>
<p class="p1"><span class="Apple-converted-space">            </span>const result = await callGemini(prompt, inlineData);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (result) { try { let items = JSON.parse(result); if (!Array.isArray(items) &amp;&amp; items.items) items = items.items; const tbody = document.getElementById('legacyTableBody'); tbody.innerHTML = ''; items.forEach((item, index) =&gt; { const row = `&lt;div class="grid grid-cols-3 gap-2 p-2 border-t border-gray-100 items-center"&gt;&lt;div class="col-span-2 text-xs"&gt;${cleanAiText(item.promise)}&lt;/div&gt;&lt;select id="aiStatus${index}" onchange="updateStatusColor(this)" class="text-xs border rounded p-1 bg-gray-50 text-gray-700"&gt;&lt;option value="Unknown" selected disabled&gt;Status?&lt;/option&gt;&lt;option value="In Progress"&gt;In Progress&lt;/option&gt;&lt;option value="Completed"&gt;Completed&lt;/option&gt;&lt;option value="Blocked"&gt;Blocked&lt;/option&gt;&lt;/select&gt;&lt;input type="hidden" id="aiPromise${index}" value="${cleanAiText(item.promise)}"&gt;&lt;/div&gt;`; tbody.innerHTML += row; }); document.getElementById('geminiResults').classList.remove('hidden'); } catch(e) { alert("Failed to parse."); } }</p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.innerText = "Analyze File"; btn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function generateCanvasPrompt() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const client = document.getElementById('clientName').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const metrics = getCheckedMetrics(); // Use dynamic</p>
<p class="p1"><span class="Apple-converted-space">            </span>const cols = { pri: document.getElementById('hexPrimary').value, sec: document.getElementById('hexSecondary').value, acc: document.getElementById('hexAccent').value };</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>let modules = [];</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModAgenda').checked) modules.push(`Agenda:\n${document.getElementById('modAgendaText').value}`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModSuccess').checked) modules.push(`Success Story:\nSituation: ${document.getElementById('modSucSit').value}\nSolution: ${document.getElementById('modSucSol').value}\nResult: ${document.getElementById('modSucRes').value}`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModRoadmap').checked) modules.push(`Short-Term Roadmap:\n30 Days: ${document.getElementById('modMap1').value}\n60 Days: ${document.getElementById('modMap2').value}\n90 Days: ${document.getElementById('modMap3').value}`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModLongTerm').checked) modules.push(`Long-Term Strategy:\n3 Months: ${document.getElementById('modLong3').value}\n6 Months: ${document.getElementById('modLong6').value}\n12 Months: ${document.getElementById('modLong12').value}`);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>const fullPrompt = `I am building a QBR presentation for ${client}.</p>
<p class="p2"><br></p>
<p class="p1">VISUAL DESIGN SYSTEM:</p>
<p class="p1">- Primary Color: ${cols.pri} (Headlines)</p>
<p class="p1">- Secondary Color: ${cols.sec} (Subheaders)</p>
<p class="p1">- Accent Color: ${cols.acc} (CTAs)</p>
<p class="p1">- Style: Modern, Clean, Card-based layout.</p>
<p class="p1">- Logo: Place client logo in bottom right.</p>
<p class="p2"><br></p>
<p class="p1">METRICS:</p>
<p class="p1">${metrics}</p>
<p class="p2"><br></p>
<p class="p1">CONTENT MODULES:</p>
<p class="p1">${modules.join('\n\n')}</p>
<p class="p2"><br></p>
<p class="p1">INSTRUCTIONS:</p>
<p class="p1">Using the data above, draft the full speaker notes and slide content. For the visual description of each slide, explicitly reference the Hex codes above.`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('canvasPromptOutput').value = fullPrompt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>togglePromptModal();</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>async function generateAiDeck() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const btn = document.getElementById('btnAiDeck');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const originalText = btn.innerHTML;</p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.innerHTML = "✨ Constructing...";</p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.disabled = true;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const client = document.getElementById('clientName').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const metricsString = getCheckedMetrics(); // Use dynamic</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Gather inputs</p>
<p class="p1"><span class="Apple-converted-space">            </span>const successContext = `Situation: ${document.getElementById('modSucSit').value}, Solution: ${document.getElementById('modSucSol').value}, Result: ${document.getElementById('modSucRes').value}`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const attendeesContext = `Qualtrics: ${document.getElementById('modAttQualtrics').value.replace(/\n/g, ', ')}. Client: ${document.getElementById('modAttClient').value.replace(/\n/g, ', ')}`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const roadmapContext = `30 Days: ${document.getElementById('modMap1').value}, 60 Days: ${document.getElementById('modMap2').value}, 90 Days: ${document.getElementById('modMap3').value}`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const longTermContext = `3 Mo: ${document.getElementById('modLong3').value}, 6 Mo: ${document.getElementById('modLong6').value}, 12 Mo: ${document.getElementById('modLong12').value}`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const agendaContext = document.getElementById('modAgendaText').value;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>let activeModules = [];</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModAgenda').checked) activeModules.push(`Agenda (${agendaContext})`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModLegacy').checked) activeModules.push("Previous QBR Followup Analysis");</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModEngagement').checked) activeModules.push(`Engagement Analysis (NPS: ${document.getElementById('modEngNPS').value})`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModSuccess').checked) activeModules.push(`Success Story (${successContext})`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModRoadmap').checked) activeModules.push(`Short-Term Roadmap (${roadmapContext})`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModLongTerm').checked) activeModules.push(`Long Term Strategy (${longTermContext})`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModAttendees').checked) activeModules.push(`Meeting Attendees (${attendeesContext})`);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if(document.getElementById('toggleModX4').checked) activeModules.push("X4 Summit Promotion");</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const prompt = `Act as a Senior Customer Success Manager. Create a presentation structure for client "${client}".</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>Metrics: ${metricsString}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>Include these modules if present in the data below:</p>
<p class="p1"><span class="Apple-converted-space">            </span>${activeModules.join('\n')}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>Return a JSON object with this structure:</p>
<p class="p1"><span class="Apple-converted-space">            </span>{</p>
<p class="p1"><span class="Apple-converted-space">              </span>"slides": [</p>
<p class="p1"><span class="Apple-converted-space">                </span>{ "title": "...", "subtitle": "..." },<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>{ "title": "...", "bullets": ["..."], "chart": { "type": "bar", "title": "Efficiency", "labels": ["Q1","Q2","Q3"], "values": [10, 20, 30] } },</p>
<p class="p1"><span class="Apple-converted-space">              </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>}`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const result = await callGemini(prompt);</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (result) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>try {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const deckData = JSON.parse(result);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>renderDeck(deckData.slides, true);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>toggleSuccessModal();<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>} catch(e) { alert("AI Generation failed. Try again."); console.error(e); }</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.innerHTML = originalText;</p>
<p class="p1"><span class="Apple-converted-space">            </span>btn.disabled = false;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- PREVIEW STUDIO LOGIC ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>function togglePreview() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const modal = document.getElementById('previewModal');</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (modal.classList.contains('opacity-0')) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Open</p>
<p class="p1"><span class="Apple-converted-space">                </span>modal.classList.remove('opacity-0', 'pointer-events-none');</p>
<p class="p1"><span class="Apple-converted-space">                </span>buildPreviewData();</p>
<p class="p1"><span class="Apple-converted-space">                </span>renderPreviewSlide(0);</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Close</p>
<p class="p1"><span class="Apple-converted-space">                </span>modal.classList.add('opacity-0', 'pointer-events-none');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function buildPreviewData() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const client = document.getElementById('clientName').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const theme = document.getElementById('aiTheme').value || "Operational Review";</p>
<p class="p1"><span class="Apple-converted-space">            </span>const cols = {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>pri: document.getElementById('colPrimary').value,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>sec: document.getElementById('colSecondary').value,</p>
<p class="p1"><span class="Apple-converted-space">                </span>acc: document.getElementById('colAccent').value,</p>
<p class="p1"><span class="Apple-converted-space">                </span>drk: document.getElementById('colDark').value</p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>previewSlides = [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 1. Cover</p>
<p class="p1"><span class="Apple-converted-space">            </span>previewSlides.push({</p>
<p class="p1"><span class="Apple-converted-space">                </span>type: 'cover',</p>
<p class="p1"><span class="Apple-converted-space">                </span>title: `QBR: ${client}`,</p>
<p class="p1"><span class="Apple-converted-space">                </span>subtitle: `Strategic Theme: ${theme}`</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 2. Agenda</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (document.getElementById('toggleModAgenda').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>previewSlides.push({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>type: 'list',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>title: 'Meeting Agenda',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>items: document.getElementById('modAgendaText').value.split('\n')</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 3. Exec Summary</p>
<p class="p1"><span class="Apple-converted-space">            </span>previewSlides.push({</p>
<p class="p1"><span class="Apple-converted-space">                </span>type: 'impact',</p>
<p class="p1"><span class="Apple-converted-space">                </span>title: 'Executive Summary',</p>
<p class="p1"><span class="Apple-converted-space">                </span>headline: document.getElementById('aiHeadline').value || "Key Performance Metrics",</p>
<p class="p1"><span class="Apple-converted-space">                </span>metric: `${document.getElementById('timeSaved').value} Hours Saved`,</p>
<p class="p1"><span class="Apple-converted-space">                </span>subMetric: 'Efficiency Gain',</p>
<p class="p1"><span class="Apple-converted-space">                </span>summary: document.getElementById('aiSummary').value || "Strong performance in key areas."</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 4. Legacy (Fixed)</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (document.getElementById('toggleModLegacy').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>previewSlides.push({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>type: 'list',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>title: 'Previous QBR Followup',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>items: ["Reviewing Action Items... (See Generated Deck for Full Table)"]<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 5. Engagement (Fixed)</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (document.getElementById('toggleModEngagement').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>previewSlides.push({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>type: 'impact',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>title: 'Engagement Analysis',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>headline: "NPS Overview",</p>
<p class="p1"><span class="Apple-converted-space">                    </span>metric: document.getElementById('modEngNPS').value,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>subMetric: "NPS Score",</p>
<p class="p1"><span class="Apple-converted-space">                    </span>summary: `Response Rate analysis based on ${document.getElementById('modEngResp').value} responses.`</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 6. Success Story</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (document.getElementById('toggleModSuccess').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>previewSlides.push({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>type: 'success',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>title: 'Strategic Win',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>sit: document.getElementById('modSucSit').value,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>sol: document.getElementById('modSucSol').value,</p>
<p class="p1"><span class="Apple-converted-space">                    </span>res: document.getElementById('modSucRes').value</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 7. Short Roadmap</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (document.getElementById('toggleModRoadmap').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>previewSlides.push({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>type: 'roadmap',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>title: '90 Day Plan',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>phases: [</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "30 Days", d: document.getElementById('modMap1').value },</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "60 Days", d: document.getElementById('modMap2').value },</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "90 Days", d: document.getElementById('modMap3').value }</p>
<p class="p1"><span class="Apple-converted-space">                    </span>]</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 8. Long Roadmap (Fixed)</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (document.getElementById('toggleModLongTerm').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>previewSlides.push({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>type: 'roadmap',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>title: '1 Year Strategy',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>phases: [</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "3 Months", d: document.getElementById('modLong3').value },</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "6 Months", d: document.getElementById('modLong6').value },</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "12 Months", d: document.getElementById('modLong12').value }</p>
<p class="p1"><span class="Apple-converted-space">                    </span>]</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 9. Attendees (Fixed)</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (document.getElementById('toggleModAttendees').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>previewSlides.push({</p>
<p class="p1"><span class="Apple-converted-space">                    </span>type: 'list',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>title: 'Attendees',</p>
<p class="p1"><span class="Apple-converted-space">                    </span>items: ["Qualtrics Team: " + document.getElementById('modAttQualtrics').value.split('\n')[0] + "...", "Client Team: " + document.getElementById('modAttClient').value.split('\n')[0] + "..."]</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 10. X4 (Fixed)</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (document.getElementById('toggleModX4').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>// Promo Slide</p>
<p class="p1"><span class="Apple-converted-space">                 </span>if (x4PromoData) {</p>
<p class="p1"><span class="Apple-converted-space">                     </span>previewSlides.push({</p>
<p class="p1"><span class="Apple-converted-space">                        </span>type: 'image_full',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>image: x4PromoData</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                 </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                     </span>previewSlides.push({</p>
<p class="p1"><span class="Apple-converted-space">                        </span>type: 'cover',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>title: 'X4 Summit',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>subtitle: 'The Experience Management Event'</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                 </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                 </span>// Speaker Slides</p>
<p class="p1"><span class="Apple-converted-space">                 </span>const speakers = document.querySelectorAll('.x4-speaker-check:checked');</p>
<p class="p1"><span class="Apple-converted-space">                 </span>speakers.forEach(sp =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                     </span>previewSlides.push({</p>
<p class="p1"><span class="Apple-converted-space">                        </span>type: 'impact',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>title: 'Keynote Speaker',</p>
<p class="p1"><span class="Apple-converted-space">                        </span>headline: sp.value,</p>
<p class="p1"><span class="Apple-converted-space">                        </span>summary: "Live at X4 Seattle",</p>
<p class="p1"><span class="Apple-converted-space">                        </span>metric: "2026",</p>
<p class="p1"><span class="Apple-converted-space">                        </span>subMetric: "Visionary"</p>
<p class="p1"><span class="Apple-converted-space">                     </span>});</p>
<p class="p1"><span class="Apple-converted-space">                 </span>});</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update Header Count</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('previewSlideCount').innerText = `${previewSlides.length} SLIDES`;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Render Dots</p>
<p class="p1"><span class="Apple-converted-space">            </span>const dots = document.getElementById('previewDots');</p>
<p class="p1"><span class="Apple-converted-space">            </span>dots.innerHTML = previewSlides.map((_, i) =&gt; `&lt;div class="w-2 h-2 rounded-full ${i === 0 ? 'bg-white' : 'bg-white/30'}"&gt;&lt;/div&gt;`).join('');</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function changePreviewSlide(dir) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>let newIndex = currentPreviewIndex + dir;</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (newIndex &lt; 0) newIndex = previewSlides.length - 1;</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (newIndex &gt;= previewSlides.length) newIndex = 0;</p>
<p class="p1"><span class="Apple-converted-space">            </span>renderPreviewSlide(newIndex);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function renderPreviewSlide(index) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>currentPreviewIndex = index;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const slide = previewSlides[index];</p>
<p class="p1"><span class="Apple-converted-space">            </span>const canvas = document.getElementById('previewCanvas');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const cols = {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>pri: document.getElementById('colPrimary').value,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>sec: document.getElementById('colSecondary').value,</p>
<p class="p1"><span class="Apple-converted-space">                </span>acc: document.getElementById('colAccent').value<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Update Dots</p>
<p class="p1"><span class="Apple-converted-space">            </span>const dots = document.getElementById('previewDots').children;</p>
<p class="p1"><span class="Apple-converted-space">            </span>for(let i=0; i&lt;dots.length; i++) dots[i].className = `w-2 h-2 rounded-full ${i === index ? 'bg-white' : 'bg-white/30'}`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Render HTML based on type</p>
<p class="p1"><span class="Apple-converted-space">            </span>let html = '';</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (slide.type === 'cover') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>html = `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="w-full h-full flex flex-col justify-center p-12 relative" style="background-color: ${document.getElementById('colNeutral').value}"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="absolute top-0 left-0 w-4 h-full" style="background-color: ${cols.pri}"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>${clientLogoData ? `&lt;img src="${clientLogoData}" class="h-12 w-auto mb-8 object-contain object-left"/&gt;` : ''}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h1 class="text-5xl font-black mb-4 text-gray-900"&gt;${slide.title}&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;p class="text-2xl font-light" style="color: ${cols.sec}"&gt;${slide.subtitle}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (slide.type === 'image_full') { // New Image Type</p>
<p class="p1"><span class="Apple-converted-space">                </span>html = `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="w-full h-full relative bg-black"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;img src="${slide.image}" class="w-full h-full object-cover" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (slide.type === 'impact') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>html = `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="w-full h-full p-12 flex flex-col bg-white"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h2 class="text-3xl font-bold mb-2" style="color: ${cols.pri}"&gt;${slide.title}&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;hr class="border-t-2 w-full mb-8" style="border-color: ${cols.acc}"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="flex-1 grid grid-cols-2 gap-8 items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;h3 class="text-xl font-bold mb-4" style="color: ${cols.sec}"&gt;${slide.headline}&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-gray-600 text-sm leading-relaxed"&gt;${slide.summary}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="bg-gray-50 p-8 rounded-xl border border-gray-100 flex flex-col items-center justify-center text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-5xl font-black mb-2" style="color: ${cols.pri}"&gt;${slide.metric}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;span class="text-sm font-bold text-gray-400 uppercase tracking-widest"&gt;${slide.subMetric}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (slide.type === 'success') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>html = `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="w-full h-full p-12 bg-white"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h2 class="text-3xl font-bold mb-8" style="color: ${cols.pri}"&gt;${slide.title}&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="grid grid-cols-3 gap-4 h-3/4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="p-4 bg-gray-50 rounded border-l-4" style="border-color: ${cols.pri}"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;h4 class="font-bold mb-2 text-gray-400 text-xs uppercase"&gt;Situation&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-sm font-medium"&gt;${slide.sit}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="p-4 bg-gray-50 rounded border-l-4" style="border-color: ${cols.sec}"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;h4 class="font-bold mb-2 text-gray-400 text-xs uppercase"&gt;Solution&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-sm font-medium"&gt;${slide.sol}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div class="p-4 bg-gray-50 rounded border-l-4" style="border-color: ${cols.acc}"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;h4 class="font-bold mb-2 text-gray-400 text-xs uppercase"&gt;Result&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p class="text-sm font-bold text-gray-900"&gt;${slide.res}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else if (slide.type === 'roadmap') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>html = `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="w-full h-full p-12 bg-white"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h2 class="text-3xl font-bold mb-8" style="color: ${cols.pri}"&gt;${slide.title}&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div class="space-y-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>${slide.phases.map((p, i) =&gt; `</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div class="flex items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="w-24 font-bold text-lg" style="color: ${i==0?cols.pri : i==1?cols.sec : cols.acc}"&gt;${p.t}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div class="flex-1 ml-4 p-3 bg-gray-50 rounded border border-gray-100 text-sm font-medium text-gray-700"&gt;${p.d}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>`).join('')}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Fallback List</p>
<p class="p1"><span class="Apple-converted-space">                </span>html = `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="w-full h-full p-12 bg-white"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h2 class="text-3xl font-bold mb-8" style="color: ${cols.pri}"&gt;${slide.title}&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;ul class="space-y-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>${slide.items ? slide.items.map(item =&gt; `&lt;li class="flex items-start"&gt;&lt;span class="mr-2 mt-1 w-2 h-2 rounded-full bg-gray-400"&gt;&lt;/span&gt;&lt;span class="text-lg text-gray-700"&gt;${item}&lt;/span&gt;&lt;/li&gt;`).join('') : ''}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/ul&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>canvas.innerHTML = html;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- 5. PPTX GENERATOR (Unified) ---</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>function generateFinalDeck() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>renderDeck(null, false);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>function renderDeck(aiSlides, isAiMode) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const pres = new PptxGenJS();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// Branding - Mapped to Semantics</p>
<p class="p1"><span class="Apple-converted-space">            </span>const cols = {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>pri: document.getElementById('colPrimary').value,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>sec: document.getElementById('colSecondary').value,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>acc: document.getElementById('colAccent').value,</p>
<p class="p1"><span class="Apple-converted-space">                </span>neu: document.getElementById('colNeutral').value,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>drk: document.getElementById('colDark').value<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>};</p>
<p class="p1"><span class="Apple-converted-space">            </span>const client = document.getElementById('clientName').value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const logoScale = parseFloat(document.getElementById('logoScale').value);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 1. MASTER SLIDE DEF (The Visual Engine)</p>
<p class="p1"><span class="Apple-converted-space">            </span>pres.defineSlideMaster({</p>
<p class="p1"><span class="Apple-converted-space">                </span>title: "MASTER",</p>
<p class="p1"><span class="Apple-converted-space">                </span>background: { color: cols.neu },</p>
<p class="p1"><span class="Apple-converted-space">                </span>objects: [</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ rect: { x: 0, y: 0, w: 0.15, h: '100%', fill: cols.pri } },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ rect: { x: 0, y: 5.3, w: '100%', h: 0.3, fill: cols.sec } },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ rect: { x: 0.2, y: 0.3, w: 0.5, h: 0.05, fill: cols.acc } },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{ ellipse: { x: 9.3, y: 0.3, w: 0.5, h: 0.5, fill: {color:cols.pri, transparency:80} } },</p>
<p class="p1"><span class="Apple-converted-space">                    </span>clientLogoData ? { image: { data: clientLogoData, x: 9.0, y: 5.0, w: 0.8 * logoScale, h: 0.4 * logoScale, sizing: { type:'contain', w:0.8 * logoScale, h:0.4 * logoScale } } } : {}</p>
<p class="p1"><span class="Apple-converted-space">                </span>]</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (isAiMode &amp;&amp; aiSlides) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// --- AI MODE ---</p>
<p class="p1"><span class="Apple-converted-space">                </span>aiSlides.forEach((slideData, index) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let s = pres.addSlide({ masterName: "MASTER" });</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (index === 0) { // Title Slide</p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addShape(pres.ShapeType.rect, { x: 0, y: 0, w: '100%', h: '100%', fill: cols.neu });<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addShape(pres.ShapeType.rect, { x: 0, y: 0, w: 3.5, h: '100%', fill: cols.pri });<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>if(clientLogoData) s.addImage({ data: clientLogoData, x: 0.5, y: 0.5, w: 2.5 * logoScale, h: 1.2 * logoScale, sizing: { type:'contain' } });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>else s.addShape(pres.ShapeType.rect, { x: 0.5, y: 0.5, w: 2.5, h: 1.2, fill: "FFFFFF", line: {color:"CCCCCC", width:1, dashType:'dash'}, text:{text:"LOGO HERE", options:{color:"CCCCCC"}} });</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addText(cleanAiText(slideData.title), { x: 4.0, y: 2.5, w: '60%', fontSize: 44, bold: true, color: cols.drk });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addText(cleanAiText(slideData.subtitle) || "", { x: 4.0, y: 4.0, w: '60%', fontSize: 24, color: cols.sec });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>// Content Slides</p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addText(cleanAiText(slideData.title), { x: 0.5, y: 0.3, w: '90%', fontSize: 32, bold: true, color: cols.pri });<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addShape(pres.ShapeType.line, { x:0.5, y:0.9, w:9.0, h:0, line:cols.acc, lineSize:2 });<span class="Apple-converted-space"> </span></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                        </span>if (slideData.chart) {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>// Split Layout</p>
<p class="p1"><span class="Apple-converted-space">                            </span>s.addShape(pres.ShapeType.rect, { x: 0.5, y: 1.2, w: 4.5, h: 3.8, fill: "FFFFFF", shadow: {type:'outer', color:'000000', opacity:0.1} });</p>
<p class="p1"><span class="Apple-converted-space">                            </span>if (slideData.bullets) {</p>
<p class="p1"><span class="Apple-converted-space">                                </span>let bulletObjs = slideData.bullets.map(t =&gt; ({ text: cleanAiText(t), options: { bullet: true, color: cols.drk } }));</p>
<p class="p1"><span class="Apple-converted-space">                                </span>s.addText(bulletObjs, { x: 0.6, y: 1.3, w: 4.3, h: 3.6, fontSize: 16 });</p>
<p class="p1"><span class="Apple-converted-space">                            </span>}</p>
<p class="p1"><span class="Apple-converted-space">                            </span>s.addShape(pres.ShapeType.rect, { x: 5.2, y: 1.2, w: 4.5, h: 3.8, fill: "FFFFFF", shadow: {type:'outer', color:'000000', opacity:0.1} });</p>
<p class="p1"><span class="Apple-converted-space">                            </span>let chartData = [{ name: slideData.chart.title, labels: slideData.chart.labels, values: slideData.chart.values }];</p>
<p class="p1"><span class="Apple-converted-space">                            </span>let chartType = slideData.chart.type === 'doughnut' ? pres.ChartType.doughnut : pres.ChartType.bar;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>s.addChart(chartType, chartData, { x: 5.3, y: 1.3, w: 4.3, h: 3.6, showLegend: true, title: slideData.chart.title, titleColor: cols.pri });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>// Full Layout</p>
<p class="p1"><span class="Apple-converted-space">                            </span>s.addShape(pres.ShapeType.rect, { x: 0.5, y: 1.2, w: 9.0, h: 3.8, fill: "FFFFFF", shadow: {type:'outer', color:'000000', opacity:0.1} });</p>
<p class="p1"><span class="Apple-converted-space">                            </span>if (slideData.bullets) {</p>
<p class="p1"><span class="Apple-converted-space">                                </span>let bulletObjs = slideData.bullets.map(t =&gt; ({ text: cleanAiText(t), options: { bullet: true, color: cols.drk } }));</p>
<p class="p1"><span class="Apple-converted-space">                                </span>s.addText(bulletObjs, { x: 0.6, y: 1.3, w: 8.8, h: 3.6, fontSize: 18 });</p>
<p class="p1"><span class="Apple-converted-space">                            </span>}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// --- MANUAL MODE ---</p>
<p class="p1"><span class="Apple-converted-space">                </span>const theme = document.getElementById('aiTheme').value || "Operational Review";</p>
<p class="p1"><span class="Apple-converted-space">                </span>const headline = document.getElementById('aiHeadline').value || "QBR Executive Summary";</p>
<p class="p1"><span class="Apple-converted-space">                </span>const summary = document.getElementById('aiSummary').value || "Reviewing key performance metrics.";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Slide 1: Title</p>
<p class="p1"><span class="Apple-converted-space">                </span>let s1 = pres.addSlide();</p>
<p class="p1"><span class="Apple-converted-space">                </span>s1.addShape(pres.ShapeType.rect, { x: 0, y: 0, w: '100%', h: '100%', fill: cols.neu });<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>s1.addShape(pres.ShapeType.rect, { x: 0, y: 0, w: 3.5, h: '100%', fill: cols.pri });<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>s1.addShape(pres.ShapeType.ellipse, { x: 8.0, y: 4.0, w: 3.0, h: 3.0, fill: {color:cols.acc, transparency:90} });</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>if (clientLogoData) s1.addImage({ data: clientLogoData, x: 0.5, y: 0.5, w: 2.5 * logoScale, h: 1.2 * logoScale, sizing: { type: 'contain' } });</p>
<p class="p1"><span class="Apple-converted-space">                </span>else s1.addShape(pres.ShapeType.rect, { x: 0.5, y: 0.5, w: 2.5, h: 1.2, fill: "FFFFFF", line: {color:"CCCCCC", width:1, dashType:'dash'}, text:{text:"PLACE LOGO HERE", options:{color:"CCCCCC"}} });</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>s1.addText(`QBR: ${client}`, { x: 4.0, y: 2.5, w: '60%', fontSize: 44, bold: true, color: cols.drk });</p>
<p class="p1"><span class="Apple-converted-space">                </span>s1.addText(`Theme: ${theme}`, { x: 4.0, y: 4.0, w: '60%', fontSize: 24, color: cols.sec });</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Slide 2: Agenda</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (document.getElementById('toggleModAgenda').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let s = pres.addSlide({ masterName: "MASTER" });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addText("Meeting Agenda", { x: 0.5, y: 0.3, w: '90%', fontSize: 32, bold: true, color: cols.pri });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addShape(pres.ShapeType.rect, { x: 0.5, y: 1.2, w: 9.0, h: 3.8, fill: "FFFFFF", shadow: {type:'outer', color:'000000', opacity:0.1} });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const agendaLines = document.getElementById('modAgendaText').value.split('\n');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let bulletObjs = agendaLines.map(t =&gt; ({ text: t, options: { bullet: false, color: cols.drk, breakLine: true } }));</p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addText(bulletObjs, { x: 0.8, y: 1.5, w: 8.4, h: 3.2, fontSize: 20, lineSpacing: 32 });</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Slide 3: Exec Summary</p>
<p class="p1"><span class="Apple-converted-space">                </span>let s2 = pres.addSlide({ masterName: "MASTER" });</p>
<p class="p1"><span class="Apple-converted-space">                </span>s2.addText(headline, { x: 0.5, y: 0.3, w: '90%', fontSize: 32, bold: true, color: cols.pri });</p>
<p class="p1"><span class="Apple-converted-space">                </span>s2.addShape(pres.ShapeType.line, { x:0.5, y:0.9, w:9.0, h:0, line:cols.acc, lineSize:2 });</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>s2.addShape(pres.ShapeType.rect, { x: 0.5, y: 1.2, w: 4.5, h: 3.8, fill: "FFFFFF", shadow: {type:'outer', color:'000000', opacity:0.1} });</p>
<p class="p1"><span class="Apple-converted-space">                </span>s2.addText(summary, { x: 0.6, y: 1.3, w: 4.3, fontSize: 16, color: cols.drk });</p>
<p class="p1"><span class="Apple-converted-space">                </span>s2.addShape(pres.ShapeType.ellipse, { x: 0.6, y: 2.0, w: 0.4, h: 0.4, fill: cols.acc });</p>
<p class="p1"><span class="Apple-converted-space">                </span>s2.addText([{ text: `ROI Impact: ${document.getElementById('timeSaved').value} Hours Saved`, options: { bold: true, bullet: false, color: cols.drk } }], { x: 1.1, y: 2.0, w: 3.8, h: 0.5, fontSize: 16 });</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>s2.addShape(pres.ShapeType.rect, { x: 5.2, y: 1.2, w: 4.5, h: 3.8, fill: "FFFFFF", shadow: {type:'outer', color:'000000', opacity:0.1} });</p>
<p class="p1"><span class="Apple-converted-space">                </span>let roiData = [{ name: "Hours Saved", labels: ["Q1", "Q2", "Q3"], values: [80, 110, parseInt(document.getElementById('timeSaved').value)] }];</p>
<p class="p1"><span class="Apple-converted-space">                </span>s2.addChart(pres.ChartType.bar, roiData, { x: 5.3, y: 1.3, w: 4.3, h: 3.6, showLegend: false, title: "Efficiency Gains", titleColor: cols.pri });</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Legacy</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (document.getElementById('toggleModLegacy').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let s = pres.addSlide({ masterName: "MASTER" });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addText("Previous QBR Followup Analysis", { x: 0.5, y: 0.3, fontSize: 24, bold: true, color: cols.pri });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const rows = [[{ text: "Promise", options: { bold: true, fill: cols.pri, color: "FFFFFF" } }, { text: "Status", options: { bold: true, fill: cols.pri, color: "FFFFFF" } }]];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const tbody = document.getElementById('legacyTableBody');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (tbody) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>tbody.querySelectorAll('div.grid').forEach((div, idx) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const p = document.getElementById(`aiPromise${idx}`).value;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>const st = document.getElementById(`aiStatus${idx}`).value;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>let statusColor = cols.drk;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>if(st==="Completed") statusColor = "#008000";<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>if(st==="Blocked") statusColor = "#FF0000";</p>
<p class="p1"><span class="Apple-converted-space">                            </span>rows.push([p, {text: st, options:{color: statusColor, bold:true}}]);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>});</p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addTable(rows, { x: 1, y: 1.5, w: 8, border: { pt: 1, color: "CCCCCC" } });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Engagement</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (document.getElementById('toggleModEngagement').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let s = pres.addSlide({ masterName: "MASTER" });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addText("Engagement Analysis", { x: 0.5, y: 0.3, fontSize: 24, bold: true, color: cols.pri });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addShape(pres.ShapeType.rect, { x: 0.5, y: 1.0, w: 9.0, h: 4.0, fill: "FFFFFF", shadow: {type:'outer', color:'000000', opacity:0.1} });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let npsVal = parseInt(document.getElementById('modEngNPS').value);</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let chartData = [{ name: "NPS", labels: ["Promoters", "Others"], values: [npsVal, 100-npsVal] }];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addChart(pres.ChartType.doughnut, chartData, { x: 1.5, y: 1.2, w: 7.0, h: 3.6, holeSize: 60, showLegend: true });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addText(`${npsVal}`, { x: 4.5, y: 2.8, fontSize: 40, bold: true, align:'center', color: cols.pri });<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Success Story</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (document.getElementById('toggleModSuccess').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let s = pres.addSlide({ masterName: "MASTER" });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addText("Success Story", { x: 0.5, y: 0.3, fontSize: 24, bold: true, color: cols.pri });</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>const cards = [</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "Situation", c: document.getElementById('modSucSit').value, x: 0.5 },</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "Solution", c: document.getElementById('modSucSol').value, x: 3.7 },</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "Result", c: document.getElementById('modSucRes').value, x: 6.9 }</p>
<p class="p1"><span class="Apple-converted-space">                    </span>];</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>cards.forEach(card =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addShape(pres.ShapeType.rect, { x: card.x, y: 1.2, w: 2.8, h: 3.8, fill: "FFFFFF", shadow: {type:'outer', color:'000000', opacity:0.1} });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addText(card.t, { x: card.x + 0.1, y: 1.4, w: 2.6, fontSize: 16, bold: true, color: cols.pri, align:'center' });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addText(card.c, { x: card.x + 0.1, y: 2.0, w: 2.6, fontSize: 14, color: cols.drk, align:'center' });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addShape(pres.ShapeType.rect, { x: 7.5, y: 0.3, w: 2.0, h: 0.5, fill: "EEEEEE", line: {color:"999999", dashType:'dash'}, text:{text:"INSERT GRAPH", options:{color:"999999", fontSize:10}} });</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Short Roadmap</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (document.getElementById('toggleModRoadmap').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let s = pres.addSlide({ masterName: "MASTER" });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addText("Tactical Roadmap (90 Days)", { x: 0.5, y: 0.3, fontSize: 24, bold: true, color: cols.pri });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addShape(pres.ShapeType.rect, { x: 0.5, y: 1.2, w: 9.0, h: 3.8, fill: "FFFFFF", shadow: {type:'outer', color:'000000', opacity:0.1} });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const phases = [</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "30 Days", d: document.getElementById('modMap1').value, y: 1.5, c: cols.pri },</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "60 Days", d: document.getElementById('modMap2').value, y: 2.5, c: cols.sec },</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "90 Days", d: document.getElementById('modMap3').value, y: 3.5, c: cols.acc }</p>
<p class="p1"><span class="Apple-converted-space">                    </span>];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>phases.forEach(p =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addText(p.t, { x: 1.0, y: p.y, w: 2.0, fontSize: 18, bold: true, color: p.c });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addText(p.d, { x: 3.0, y: p.y, w: 6.0, fontSize: 18, color: cols.drk });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addShape(pres.ShapeType.line, { x:1.0, y:p.y+0.6, w:8.0, h:0, line:"EEEEEE" });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Long Term Roadmap</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (document.getElementById('toggleModLongTerm').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let s = pres.addSlide({ masterName: "MASTER" });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addText("Strategic Roadmap (1 Year)", { x: 0.5, y: 0.3, fontSize: 24, bold: true, color: cols.pri });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>s.addShape(pres.ShapeType.rect, { x: 0.5, y: 1.2, w: 9.0, h: 3.8, fill: "FFFFFF", shadow: {type:'outer', color:'000000', opacity:0.1} });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const phases = [</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "3 Months", d: document.getElementById('modLong3').value, y: 1.5, c: cols.pri },</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "6 Months", d: document.getElementById('modLong6').value, y: 2.5, c: cols.sec },</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{ t: "12 Months", d: document.getElementById('modLong12').value, y: 3.5, c: cols.acc }</p>
<p class="p1"><span class="Apple-converted-space">                    </span>];</p>
<p class="p1"><span class="Apple-converted-space">                    </span>phases.forEach(p =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addText(p.t, { x: 1.0, y: p.y, w: 2.0, fontSize: 18, bold: true, color: p.c });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addText(p.d, { x: 3.0, y: p.y, w: 6.0, fontSize: 18, color: cols.drk });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>s.addShape(pres.ShapeType.line, { x:1.0, y:p.y+0.6, w:8.0, h:0, line:"EEEEEE" });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// Attendees</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (document.getElementById('toggleModAttendees').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let sQ = pres.addSlide({ masterName: "MASTER" });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>sQ.addText("Qualtrics Team", { x: 0.5, y: 0.3, fontSize: 24, bold: true, color: cols.pri });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>sQ.addShape(pres.ShapeType.rect, { x: 0.5, y: 1.0, w: 9.0, h: 4.0, fill: "FFFFFF", shadow: {type:'outer', color:'000000', opacity:0.1} });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const qText = document.getElementById('modAttQualtrics').value.split('\n');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let qRows = []; qText.forEach(l =&gt; qRows.push([{ text: l, options: { bullet: true, color: cols.drk } }]));</p>
<p class="p1"><span class="Apple-converted-space">                    </span>sQ.addTable(qRows, { x: 1, y: 1.5, w: 8, border: null });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>sQ.addShape(pres.ShapeType.rect, { x: 7.5, y: 0.3, w: 2.0, h: 0.5, fill: "EEEEEE", line: {color:"999999", dashType:'dash'}, text:{text:"INSERT HEADSHOTS", options:{color:"999999", fontSize:10}} });</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>let sC = pres.addSlide({ masterName: "MASTER" });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>sC.addText(`${client} Team`, { x: 0.5, y: 0.3, fontSize: 24, bold: true, color: cols.sec });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>sC.addShape(pres.ShapeType.rect, { x: 0.5, y: 1.0, w: 9.0, h: 4.0, fill: "FFFFFF", shadow: {type:'outer', color:'000000', opacity:0.1} });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const cText = document.getElementById('modAttClient').value.split('\n');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let cRows = []; cText.forEach(l =&gt; cRows.push([{ text: l, options: { bullet: true, color: cols.drk } }]));</p>
<p class="p1"><span class="Apple-converted-space">                    </span>sC.addTable(cRows, { x: 1, y: 1.5, w: 8, border: null });</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// X4 Logic (Updated)</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (document.getElementById('toggleModX4').checked) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>let sX4 = pres.addSlide({ masterName: "MASTER" });</p>
<p class="p2"><span class="Apple-converted-space">                    </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Promo Slide (Image or Fallback)</p>
<p class="p1"><span class="Apple-converted-space">                    </span>if (x4PromoData) {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>// Full screen image override</p>
<p class="p1"><span class="Apple-converted-space">                        </span>sX4.addImage({ data: x4PromoData, x: 0, y: 0, w: '100%', h: '100%' });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>// Fallback Text</p>
<p class="p1"><span class="Apple-converted-space">                        </span>sX4.addShape(pres.ShapeType.rect, { x: 0, y: 0, w: '100%', h: '100%', fill: '1E1E1E' });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>sX4.addText("Qualtrics X4 Summit", { x: 1, y: 2.5, fontSize: 44, bold: true, color: "FFFFFF", align: "center" });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>sX4.addText("The Experience Management Event", { x: 1, y: 3.5, fontSize: 18, color: "CCCCCC", align: "center" });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                    </span>// Speaker Slides</p>
<p class="p1"><span class="Apple-converted-space">                    </span>const speakers = document.querySelectorAll('.x4-speaker-check:checked');</p>
<p class="p1"><span class="Apple-converted-space">                    </span>speakers.forEach(sp =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                        </span>let sSp = pres.addSlide({ masterName: "MASTER" });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>sSp.addText("Keynote Speaker", { x: 0.5, y: 0.3, fontSize: 24, bold: true, color: cols.pri });</p>
<p class="p2"><span class="Apple-converted-space">                        </span></p>
<p class="p1"><span class="Apple-converted-space">                        </span>// Speaker Layout</p>
<p class="p1"><span class="Apple-converted-space">                        </span>sSp.addShape(pres.ShapeType.rect, { x: 0.5, y: 1.2, w: 9.0, h: 3.8, fill: "FFFFFF", shadow: {type:'outer', color:'000000', opacity:0.1} });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>sSp.addText(sp.value, { x: 1.0, y: 2.5, w: 8.0, fontSize: 40, bold: true, color: cols.drk, align:'center' });</p>
<p class="p1"><span class="Apple-converted-space">                        </span>sSp.addText("Live at X4 Seattle | March 2026", { x: 1.0, y: 3.5, w: 8.0, fontSize: 18, color: cols.sec, align:'center' });</p>
<p class="p1"><span class="Apple-converted-space">                    </span>});</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>pres.writeFile({ fileName: `${client}_QBR.pptx` });</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
